{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"name":"_10.1 파이토치 MNIST 모델.ipynb의 사본","provenance":[{"file_id":"19fuJ3fsZ6y5Bq0hGcRBNdaYP_JSTzF8t","timestamp":1603382633488}],"collapsed_sections":[]},"kernelspec":{"name":"python3","display_name":"Python 3"},"accelerator":"GPU","widgets":{"application/vnd.jupyter.widget-state+json":{"34aac9beb8de42a1bd56756d5cf167f7":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_c788d18b3b0a4abdb894e7b64ba6ba1c","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_f9542007df75408eb82ef2ac32c53bc5","IPY_MODEL_43a85fe7f40e4ab6a08a7382e67ca022"]}},"c788d18b3b0a4abdb894e7b64ba6ba1c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"f9542007df75408eb82ef2ac32c53bc5":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_6ebcc0f7d7ab4f86a43cb83b8a3f00cf","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":1,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_c0a0bf33ea5b487f9529cd7a9789fde1"}},"43a85fe7f40e4ab6a08a7382e67ca022":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_68e62f1621a44a2b923f31b35437e0f8","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 9920512/? [00:03&lt;00:00, 2624222.84it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_febe2c4f1a5f4c1f9518f0ff67b0517f"}},"6ebcc0f7d7ab4f86a43cb83b8a3f00cf":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"c0a0bf33ea5b487f9529cd7a9789fde1":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"68e62f1621a44a2b923f31b35437e0f8":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"febe2c4f1a5f4c1f9518f0ff67b0517f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"83c6522e1f5c49cca9468055dac77c57":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_54bdcf57089e46ec8cbe205502ef5a77","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_ce94fd1990e746af8c295e1e3f6f17e9","IPY_MODEL_a84b3dc786004abfaf2d70ca8319bd62"]}},"54bdcf57089e46ec8cbe205502ef5a77":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"ce94fd1990e746af8c295e1e3f6f17e9":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_272e7eafd46c4ad8910f5594bdcea6f1","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":1,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_8e8f9159bc9744c8861519a76e5e878f"}},"a84b3dc786004abfaf2d70ca8319bd62":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_8b26c1a0949f4dc9ab8fdf7fbb1b941d","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 32768/? [00:00&lt;00:00, 109357.66it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_a016f631c5a74aa1a17e5b671501b0af"}},"272e7eafd46c4ad8910f5594bdcea6f1":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"8e8f9159bc9744c8861519a76e5e878f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"8b26c1a0949f4dc9ab8fdf7fbb1b941d":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"a016f631c5a74aa1a17e5b671501b0af":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"43e9a11a94f3486ca2d8f2b2a9f3c308":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_06855fc04c88439a83f0b7b1ba212c6d","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_2f3a344384e540ea94c3d3d6abb61dd8","IPY_MODEL_59a8270cb2c6407e9dee2a48721ff0b4"]}},"06855fc04c88439a83f0b7b1ba212c6d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"2f3a344384e540ea94c3d3d6abb61dd8":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_1e687c7111324d2d8c613f609aa4373d","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":1,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_205ed047c2b34ed3993aa8306708199f"}},"59a8270cb2c6407e9dee2a48721ff0b4":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_e2a3ddcdced74ed3aae66fa0d7251b9f","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 1654784/? [00:02&lt;00:00, 819408.81it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_58f758a9fcfd4da78922e454c69b9647"}},"1e687c7111324d2d8c613f609aa4373d":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"205ed047c2b34ed3993aa8306708199f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"e2a3ddcdced74ed3aae66fa0d7251b9f":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"58f758a9fcfd4da78922e454c69b9647":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"098e62c50e854ce483baa376baf545d8":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_dee5cd945ded479a99dc26df7f8dd650","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_0fa99db353bd44febeaf742588cbfd81","IPY_MODEL_1550c470ca054bd8a1700cef0d28de17"]}},"dee5cd945ded479a99dc26df7f8dd650":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"0fa99db353bd44febeaf742588cbfd81":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_f4fe23c25ae34310a505c4ec98e20c73","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":1,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_06f0281801fe487786e901d05e689ada"}},"1550c470ca054bd8a1700cef0d28de17":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_47db9252384e4737be40e7b3760a7415","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 8192/? [00:00&lt;00:00, 18409.76it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_bfc633dff352447a80fc6b61c0759d08"}},"f4fe23c25ae34310a505c4ec98e20c73":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"06f0281801fe487786e901d05e689ada":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"47db9252384e4737be40e7b3760a7415":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"bfc633dff352447a80fc6b61c0759d08":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}}}}},"cells":[{"cell_type":"markdown","metadata":{"id":"N70Zo_KMAg1H"},"source":["# 파이토치 MNIST 모델"]},{"cell_type":"markdown","metadata":{"id":"aNj9ScsbAlr-"},"source":["## modules import "]},{"cell_type":"code","metadata":{"id":"IaKgb-5BAj68","executionInfo":{"status":"ok","timestamp":1603779390619,"user_tz":-540,"elapsed":5450,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}}},"source":["import torch\n","import torch.nn as nn\n","import torch.nn.functional as F\n","import torch.optim as optim\n","\n","from torch.utils.data import Dataset, DataLoader\n","\n","import torchvision\n","import torchvision.datasets\n","import torchvision.transforms as transforms\n","\n","import numpy as np\n","import matplotlib.pyplot as plt\n","plt.style.use(['seaborn-white'])"],"execution_count":1,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"-v_WXu5iDfZK"},"source":["## 전처리 설정\n","- `transform.Compose`"]},{"cell_type":"code","metadata":{"id":"Xu74M5BxDiLH","executionInfo":{"status":"ok","timestamp":1603779390621,"user_tz":-540,"elapsed":5448,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}}},"source":["transform = transforms.Compose([transforms.ToTensor(), \n","                                 transforms.Normalize((0.5,), (0.5, ))])"],"execution_count":2,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"E-eus2CsDoEe"},"source":["## 데이터 로드 및 데이터 확인"]},{"cell_type":"code","metadata":{"id":"P9FURlkCDnja","executionInfo":{"status":"ok","timestamp":1603779393860,"user_tz":-540,"elapsed":8625,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"9d46c8c8-a1f4-4929-da7c-87a2b5ee022b","colab":{"base_uri":"https://localhost:8080/","height":399,"referenced_widgets":["34aac9beb8de42a1bd56756d5cf167f7","c788d18b3b0a4abdb894e7b64ba6ba1c","f9542007df75408eb82ef2ac32c53bc5","43a85fe7f40e4ab6a08a7382e67ca022","6ebcc0f7d7ab4f86a43cb83b8a3f00cf","c0a0bf33ea5b487f9529cd7a9789fde1","68e62f1621a44a2b923f31b35437e0f8","febe2c4f1a5f4c1f9518f0ff67b0517f","83c6522e1f5c49cca9468055dac77c57","54bdcf57089e46ec8cbe205502ef5a77","ce94fd1990e746af8c295e1e3f6f17e9","a84b3dc786004abfaf2d70ca8319bd62","272e7eafd46c4ad8910f5594bdcea6f1","8e8f9159bc9744c8861519a76e5e878f","8b26c1a0949f4dc9ab8fdf7fbb1b941d","a016f631c5a74aa1a17e5b671501b0af","43e9a11a94f3486ca2d8f2b2a9f3c308","06855fc04c88439a83f0b7b1ba212c6d","2f3a344384e540ea94c3d3d6abb61dd8","59a8270cb2c6407e9dee2a48721ff0b4","1e687c7111324d2d8c613f609aa4373d","205ed047c2b34ed3993aa8306708199f","e2a3ddcdced74ed3aae66fa0d7251b9f","58f758a9fcfd4da78922e454c69b9647","098e62c50e854ce483baa376baf545d8","dee5cd945ded479a99dc26df7f8dd650","0fa99db353bd44febeaf742588cbfd81","1550c470ca054bd8a1700cef0d28de17","f4fe23c25ae34310a505c4ec98e20c73","06f0281801fe487786e901d05e689ada","47db9252384e4737be40e7b3760a7415","bfc633dff352447a80fc6b61c0759d08"]}},"source":["trainset = torchvision.datasets.MNIST(root='./data',\n","                                      train=True,\n","                                      download=True,\n","                                      transform=transform)\n","\n","testset = torchvision.datasets.MNIST(root='./data',\n","                                     train=False,\n","                                     download=True,\n","                                     transform=transform)"],"execution_count":3,"outputs":[{"output_type":"stream","text":["Downloading http://yann.lecun.com/exdb/mnist/train-images-idx3-ubyte.gz to ./data/MNIST/raw/train-images-idx3-ubyte.gz\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"34aac9beb8de42a1bd56756d5cf167f7","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=1.0, bar_style='info', max=1.0), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["Extracting ./data/MNIST/raw/train-images-idx3-ubyte.gz to ./data/MNIST/raw\n","Downloading http://yann.lecun.com/exdb/mnist/train-labels-idx1-ubyte.gz to ./data/MNIST/raw/train-labels-idx1-ubyte.gz\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"83c6522e1f5c49cca9468055dac77c57","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=1.0, bar_style='info', max=1.0), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["Extracting ./data/MNIST/raw/train-labels-idx1-ubyte.gz to ./data/MNIST/raw\n","Downloading http://yann.lecun.com/exdb/mnist/t10k-images-idx3-ubyte.gz to ./data/MNIST/raw/t10k-images-idx3-ubyte.gz\n","\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"43e9a11a94f3486ca2d8f2b2a9f3c308","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=1.0, bar_style='info', max=1.0), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["Extracting ./data/MNIST/raw/t10k-images-idx3-ubyte.gz to ./data/MNIST/raw\n","Downloading http://yann.lecun.com/exdb/mnist/t10k-labels-idx1-ubyte.gz to ./data/MNIST/raw/t10k-labels-idx1-ubyte.gz\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"098e62c50e854ce483baa376baf545d8","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=1.0, bar_style='info', max=1.0), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["Extracting ./data/MNIST/raw/t10k-labels-idx1-ubyte.gz to ./data/MNIST/raw\n","Processing...\n","Done!\n"],"name":"stdout"},{"output_type":"stream","text":["/usr/local/lib/python3.6/dist-packages/torchvision/datasets/mnist.py:469: UserWarning: The given NumPy array is not writeable, and PyTorch does not support non-writeable tensors. This means you can write to the underlying (supposedly non-writeable) NumPy array using the tensor. You may want to copy the array to protect its data or make it writeable before converting it to a tensor. This type of warning will be suppressed for the rest of this program. (Triggered internally at  /pytorch/torch/csrc/utils/tensor_numpy.cpp:141.)\n","  return torch.from_numpy(parsed.astype(m[2], copy=False)).view(*s)\n"],"name":"stderr"}]},{"cell_type":"code","metadata":{"id":"YYAssGe4Dy3c","executionInfo":{"status":"ok","timestamp":1603779393860,"user_tz":-540,"elapsed":8623,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}}},"source":["train_loader = DataLoader(trainset,\n","                          batch_size=128,\n","                          shuffle=True,\n","                          num_workers=2)\n","\n","test_loader = DataLoader(testset,\n","                         batch_size=128,\n","                         shuffle=False,\n","                         num_workers=2)"],"execution_count":4,"outputs":[]},{"cell_type":"code","metadata":{"id":"X6gBiInXEG19","executionInfo":{"status":"ok","timestamp":1603779393861,"user_tz":-540,"elapsed":8622,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"eda2c765-0221-4956-836b-e6a04c4e1e6b","colab":{"base_uri":"https://localhost:8080/","height":71}},"source":["image, label = next(iter(train_loader))"],"execution_count":5,"outputs":[{"output_type":"stream","text":["\n","\n","\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"maF2sZwmEqYh","executionInfo":{"status":"ok","timestamp":1603779393862,"user_tz":-540,"elapsed":8615,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"0e1e1646-83da-46ad-ad56-aac6b306f70d","colab":{"base_uri":"https://localhost:8080/","height":35}},"source":["image.shape, label.shape"],"execution_count":6,"outputs":[{"output_type":"execute_result","data":{"text/plain":["(torch.Size([128, 1, 28, 28]), torch.Size([128]))"]},"metadata":{"tags":[]},"execution_count":6}]},{"cell_type":"code","metadata":{"id":"IwylR2BtFDCf","executionInfo":{"status":"ok","timestamp":1603779393862,"user_tz":-540,"elapsed":8614,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}}},"source":["def imshow(img):\n","  img = img / 2 + .5\n","  npimg = img.numpy()\n","  fig = plt.figure(figsize=(10,5))\n","  plt.imshow(np.transpose(npimg, (1,2,0)))\n","  plt.show()"],"execution_count":7,"outputs":[]},{"cell_type":"code","metadata":{"id":"4NKMcdmuFF7m","executionInfo":{"status":"ok","timestamp":1603779394429,"user_tz":-540,"elapsed":9173,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"b4efa48d-5fa5-4539-ad5a-d0b188b256f2","colab":{"base_uri":"https://localhost:8080/","height":228}},"source":["dataiter = iter(train_loader)\n","images, labels = dataiter.next()\n","imshow(torchvision.utils.make_grid(images[:4]))"],"execution_count":8,"outputs":[{"output_type":"display_data","data":{"image/png":"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\n","text/plain":["<Figure size 720x360 with 1 Axes>"]},"metadata":{"tags":[],"needs_background":"light"}},{"output_type":"stream","text":["\n","\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"GCxg2k3oFjwk"},"source":["## 신경망 구성"]},{"cell_type":"code","metadata":{"id":"igYMZcWgBCML","executionInfo":{"status":"ok","timestamp":1603779394430,"user_tz":-540,"elapsed":9165,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"7359c6b9-138b-4d45-93b9-c1b9c0af63ac","colab":{"base_uri":"https://localhost:8080/","height":143}},"source":["class Net(nn.Module):\n","  def __init__(self):\n","    super(Net, self).__init__()\n","\n","    self.conv1 = nn.Conv2d(1, 6, 3)\n","    self.conv2 = nn.Conv2d(6, 16, 3)\n","    self.fc1 = nn.Linear(16 * 5 * 5, 120)\n","    self.fc2 = nn.Linear(120, 84)\n","    self.fc3 = nn.Linear(84, 10)\n","\n","  def forward(self, x):\n","    x = F.max_pool2d(F.relu(self.conv1(x)), (2,2))\n","    x = F.max_pool2d(F.relu(self.conv2(x)), 2)\n","    x = x.view(-1, self.num_flat_featrues(x))\n","    x = F.relu(self.fc1(x))\n","    x = F.relu(self.fc2(x))\n","    x = self.fc3(x)\n","    return x\n","\n","  def num_flat_featrues(self, x):\n","    size = x.size()[1:]\n","    num_features =  1\n","    for s in size:\n","      num_features *= s\n","    \n","    return num_features\n","  \n","net = Net()\n","print(net)"],"execution_count":9,"outputs":[{"output_type":"stream","text":["Net(\n","  (conv1): Conv2d(1, 6, kernel_size=(3, 3), stride=(1, 1))\n","  (conv2): Conv2d(6, 16, kernel_size=(3, 3), stride=(1, 1))\n","  (fc1): Linear(in_features=400, out_features=120, bias=True)\n","  (fc2): Linear(in_features=120, out_features=84, bias=True)\n","  (fc3): Linear(in_features=84, out_features=10, bias=True)\n",")\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"6CN4Kbd9FliP"},"source":["- `.parameters()` "]},{"cell_type":"code","metadata":{"id":"ZxxZoCC-Fn9b","executionInfo":{"status":"ok","timestamp":1603779394430,"user_tz":-540,"elapsed":9157,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"6ea5cff0-2dec-4e89-a6c0-a333191fc7c7","colab":{"base_uri":"https://localhost:8080/","height":53}},"source":["params = list(net.parameters())\n","print(len(params))\n","print(params[0].size())"],"execution_count":10,"outputs":[{"output_type":"stream","text":["10\n","torch.Size([6, 1, 3, 3])\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"jelPFbNgFwmG"},"source":["임의의 값을 넣어 forward값 확인"]},{"cell_type":"code","metadata":{"id":"nI-7V1oUFoxG","executionInfo":{"status":"ok","timestamp":1603779394431,"user_tz":-540,"elapsed":9150,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"a7496447-5672-445c-e0ff-6caa6377ef6d","colab":{"base_uri":"https://localhost:8080/","height":53}},"source":["input = torch.randn(1, 1, 28, 28)\n","out = net(input)\n","print(out)"],"execution_count":11,"outputs":[{"output_type":"stream","text":["tensor([[ 0.0825, -0.2336, -0.1465, -0.0338,  0.0511,  0.1143,  0.0595, -0.0989,\n","          0.0677,  0.0712]], grad_fn=<AddmmBackward>)\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"hFAKDY87FRuu"},"source":["## 손실함수와 옵티마이저"]},{"cell_type":"code","metadata":{"id":"XHGAenL0Fu7R","executionInfo":{"status":"ok","timestamp":1603779394431,"user_tz":-540,"elapsed":9147,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}}},"source":["criterion = nn.CrossEntropyLoss()\n","optimizer = optim.SGD(net.parameters(), lr=0.001, momentum=0.9)"],"execution_count":12,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"NV5_xdUsGB1x"},"source":["## 모델 학습\n","\n","- `optimizer.zero_grad` : 가중치의 그래디언트 초기화\n","\n","- loss 계산\n","\n","- `loss.backward()`\n","\n","- `optmizer.step()` : 업데이트"]},{"cell_type":"markdown","metadata":{"id":"rBIYk0aTGEPW"},"source":["- 배치수 확인"]},{"cell_type":"code","metadata":{"id":"qax43PdgDQBk","executionInfo":{"status":"ok","timestamp":1603779394431,"user_tz":-540,"elapsed":9139,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"8b8c25e0-289b-438e-c88f-3d7d820d1aaf","colab":{"base_uri":"https://localhost:8080/","height":35}},"source":["total_batch = len(train_loader)\n","print(total_batch)"],"execution_count":13,"outputs":[{"output_type":"stream","text":["469\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"4eHTyg6eHzMI"},"source":["- 설명을 위해 `epochs=2`로 지정"]},{"cell_type":"code","metadata":{"id":"NzwisgcADQOD","executionInfo":{"status":"ok","timestamp":1603779424062,"user_tz":-540,"elapsed":38762,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"77dadfc5-1a56-40a8-bfd3-d0c11a6c3ecb","colab":{"base_uri":"https://localhost:8080/","height":161}},"source":["for epoch in range(2):\n","  running_loss = 0.0\n","  for i, data in enumerate(train_loader, 0):\n","    inputs, labels = data\n","\n","    optimizer.zero_grad()\n","\n","    outputs = net(inputs)\n","    loss = criterion(outputs, labels)\n","    loss.backward()\n","    optimizer.step()\n","\n","    running_loss += loss.item()\n","    if i % 100 ==99:\n","      print(\"Epoch:{}, Iter:{}, Loss{}\".format(epoch+1, i+1, running_loss /2000))\n","      running_loss = 0.0"],"execution_count":14,"outputs":[{"output_type":"stream","text":["Epoch:1, Iter:100, Loss0.11543008279800415\n","Epoch:1, Iter:200, Loss0.11512387466430664\n","Epoch:1, Iter:300, Loss0.11491614162921905\n","Epoch:1, Iter:400, Loss0.11462455677986146\n","Epoch:2, Iter:100, Loss0.1139942625761032\n","Epoch:2, Iter:200, Loss0.11332045328617096\n","Epoch:2, Iter:300, Loss0.11212912166118622\n","Epoch:2, Iter:400, Loss0.10954848647117615\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"tumNqvreIMUC"},"source":["## 모델의 저장 및 로드\n","\n","- `torch.save`\n","  - `net.state_dict()`를 저장\n","\n","- `torch.load`\n","  - `load_state_dict`로 모델을 로드"]},{"cell_type":"code","metadata":{"id":"lxj4a7oHDQRR","executionInfo":{"status":"ok","timestamp":1603779424063,"user_tz":-540,"elapsed":38761,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}}},"source":["PATH = './mnist_net.pth'\n","torch.save(net.state_dict(), PATH)"],"execution_count":15,"outputs":[]},{"cell_type":"code","metadata":{"id":"9GqVJlGzDQTe","executionInfo":{"status":"ok","timestamp":1603779424063,"user_tz":-540,"elapsed":38753,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"8c798e2a-1c35-4dc0-9c09-5c241722d844","colab":{"base_uri":"https://localhost:8080/","height":35}},"source":["net = Net()\n","net.load_state_dict(torch.load(PATH))"],"execution_count":16,"outputs":[{"output_type":"execute_result","data":{"text/plain":["<All keys matched successfully>"]},"metadata":{"tags":[]},"execution_count":16}]},{"cell_type":"code","metadata":{"id":"15cyBDq0DQV2","executionInfo":{"status":"ok","timestamp":1603779424064,"user_tz":-540,"elapsed":38745,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"5aafcc2a-4b19-4e95-f677-04dbf1603c51","colab":{"base_uri":"https://localhost:8080/","height":143}},"source":["net.parameters"],"execution_count":17,"outputs":[{"output_type":"execute_result","data":{"text/plain":["<bound method Module.parameters of Net(\n","  (conv1): Conv2d(1, 6, kernel_size=(3, 3), stride=(1, 1))\n","  (conv2): Conv2d(6, 16, kernel_size=(3, 3), stride=(1, 1))\n","  (fc1): Linear(in_features=400, out_features=120, bias=True)\n","  (fc2): Linear(in_features=120, out_features=84, bias=True)\n","  (fc3): Linear(in_features=84, out_features=10, bias=True)\n",")>"]},"metadata":{"tags":[]},"execution_count":17}]},{"cell_type":"markdown","metadata":{"id":"5IecfHZiI09W"},"source":["## 모델 테스트"]},{"cell_type":"code","metadata":{"id":"QewXif2NDQYZ","executionInfo":{"status":"ok","timestamp":1603779424064,"user_tz":-540,"elapsed":38738,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"7329162b-8b97-4e94-f9e1-e2a2ceb7e47c","colab":{"base_uri":"https://localhost:8080/","height":192}},"source":["dataiter = iter(test_loader)\n","images, labels = dataiter.next()\n","\n","imshow(torchvision.utils.make_grid(images[:4]))"],"execution_count":18,"outputs":[{"output_type":"display_data","data":{"image/png":"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\n","text/plain":["<Figure size 720x360 with 1 Axes>"]},"metadata":{"tags":[],"needs_background":"light"}}]},{"cell_type":"code","metadata":{"id":"ELx5TrT-DQao","executionInfo":{"status":"ok","timestamp":1603779424065,"user_tz":-540,"elapsed":38737,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}}},"source":["outputs = net(images)"],"execution_count":19,"outputs":[]},{"cell_type":"code","metadata":{"id":"9yaMMa8VDQdI","executionInfo":{"status":"ok","timestamp":1603779424065,"user_tz":-540,"elapsed":38728,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"ecc2b2cb-6263-48c4-b6b6-91aa4af27d65","colab":{"base_uri":"https://localhost:8080/","height":125}},"source":["_, predicted = torch.max(outputs, 1)\n","print(predicted)"],"execution_count":20,"outputs":[{"output_type":"stream","text":["tensor([9, 0, 1, 0, 9, 1, 9, 9, 0, 9, 0, 0, 9, 0, 1, 0, 9, 9, 6, 9, 9, 0, 9, 0,\n","        9, 0, 9, 9, 0, 1, 9, 1, 6, 0, 9, 0, 9, 1, 0, 1, 1, 9, 9, 0, 9, 0, 9, 9,\n","        9, 9, 0, 0, 0, 0, 6, 0, 9, 1, 9, 0, 9, 0, 9, 9, 9, 9, 9, 9, 9, 0, 9, 0,\n","        0, 9, 1, 9, 0, 9, 9, 9, 9, 6, 0, 9, 0, 9, 9, 0, 6, 1, 0, 6, 4, 9, 9, 9,\n","        9, 9, 0, 9, 6, 0, 0, 9, 0, 9, 0, 1, 9, 9, 0, 1, 9, 9, 9, 9, 9, 9, 9, 9,\n","        0, 9, 9, 6, 9, 9, 0, 0])\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"qOQWilyPOja5","executionInfo":{"status":"ok","timestamp":1603779424066,"user_tz":-540,"elapsed":38721,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"324c2a99-f7cb-4c9f-86ca-8469a9872968","colab":{"base_uri":"https://localhost:8080/","height":35}},"source":["print(''.join('{}\\t'.format(str(predicted[j].numpy())) for j in range(4)))"],"execution_count":21,"outputs":[{"output_type":"stream","text":["9\t0\t1\t0\t\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"T1qsc9TUDQfk","executionInfo":{"status":"ok","timestamp":1603779426860,"user_tz":-540,"elapsed":41507,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"c9b61563-5c8c-41d4-8e43-d38be429f11d","colab":{"base_uri":"https://localhost:8080/","height":35}},"source":["correct = 0\n","total = 0\n","\n","with torch.no_grad():\n","  for data in test_loader:\n","    images, labels = data\n","    outputs = net(images)\n","    _, predicted = torch.max(outputs.data, 1)\n","    total += labels.size(0)\n","    correct += (predicted == labels).sum().item()\n","\n","  \n","print(100 * correct / total)"],"execution_count":22,"outputs":[{"output_type":"stream","text":["35.79\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"HQBRrbueR94k"},"source":["## GPU 설정 후 학습\n","- 설정 후, 모델과 데이터에 `to`로 GPU를 사용 가능한 형태로 변환 해줘야 한다.\n","\n","- `.cuda()` 로도 가능"]},{"cell_type":"code","metadata":{"id":"uaO3lXxRjslc","executionInfo":{"status":"ok","timestamp":1603779426861,"user_tz":-540,"elapsed":41507,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}}},"source":["import torch\n","import torch.nn as nn\n","import torch.nn.functional as F\n","import torch.optim as optim\n","\n","from torch.utils.data import Dataset, DataLoader\n","\n","import torchvision\n","import torchvision.datasets\n","import torchvision.transforms as transforms\n","\n","import numpy as np\n","import matplotlib.pyplot as plt\n","plt.style.use(['seaborn-white'])"],"execution_count":23,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"02LdHlTTSz5L"},"source":["- 현재 GPU 설정"]},{"cell_type":"code","metadata":{"id":"Ybsjn80uSx3X","executionInfo":{"status":"ok","timestamp":1603779426861,"user_tz":-540,"elapsed":41498,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"5d0dc0a7-8bdd-47ba-ac90-ef879e013ea2","colab":{"base_uri":"https://localhost:8080/","height":35}},"source":["torch.cuda.is_available()"],"execution_count":24,"outputs":[{"output_type":"execute_result","data":{"text/plain":["True"]},"metadata":{"tags":[]},"execution_count":24}]},{"cell_type":"code","metadata":{"id":"HlPZI5wfDQhv","executionInfo":{"status":"ok","timestamp":1603779426862,"user_tz":-540,"elapsed":41497,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}}},"source":["use_cuda = torch.cuda.is_available()\n","device = torch.device(\"cuda\" if use_cuda else \"cpu\")"],"execution_count":25,"outputs":[]},{"cell_type":"code","metadata":{"id":"ykIP4ceaSCib","executionInfo":{"status":"ok","timestamp":1603779426862,"user_tz":-540,"elapsed":41485,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"4e828db7-0832-4445-93fe-01e95dcb2605","colab":{"base_uri":"https://localhost:8080/","height":35}},"source":["device"],"execution_count":26,"outputs":[{"output_type":"execute_result","data":{"text/plain":["device(type='cuda')"]},"metadata":{"tags":[]},"execution_count":26}]},{"cell_type":"markdown","metadata":{"id":"JZ6fOMoakAIi"},"source":["- 데이터 로드\n"]},{"cell_type":"code","metadata":{"id":"WUwhAT3IkBbN","executionInfo":{"status":"ok","timestamp":1603779426863,"user_tz":-540,"elapsed":41477,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}}},"source":["transform = transforms.Compose([transforms.ToTensor(), \n","                                 transforms.Normalize((0.5,), (0.5, ))])\n","\n","trainset = torchvision.datasets.MNIST(root='./data',\n","                                      train=True,\n","                                      download=True,\n","                                      transform=transform)\n","\n","testset = torchvision.datasets.MNIST(root='./data',\n","                                     train=False,\n","                                     download=True,\n","                                     transform=transform)\n","\n","train_loader = DataLoader(trainset,\n","                          batch_size=128,\n","                          shuffle=True,\n","                          num_workers=2)\n","\n","test_loader = DataLoader(testset,\n","                         batch_size=128,\n","                         shuffle=False,\n","                         num_workers=2)"],"execution_count":27,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"34WyPzrzS8Cd"},"source":["- 모델 생성"]},{"cell_type":"code","metadata":{"id":"lpFTp1Tbjyeb","executionInfo":{"status":"ok","timestamp":1603779426863,"user_tz":-540,"elapsed":41469,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"9a8f6c71-8685-4298-c2e8-d64a842e760f","colab":{"base_uri":"https://localhost:8080/","height":143}},"source":["class Net(nn.Module):\n","  def __init__(self):\n","    super(Net, self).__init__()\n","\n","    self.conv1 = nn.Conv2d(1, 6, 3)\n","    self.conv2 = nn.Conv2d(6, 16, 3)\n","    self.fc1 = nn.Linear(16 * 5 * 5, 120)\n","    self.fc2 = nn.Linear(120, 84)\n","    self.fc3 = nn.Linear(84, 10)\n","\n","  def forward(self, x):\n","    x = F.max_pool2d(F.relu(self.conv1(x)), (2,2))\n","    x = F.max_pool2d(F.relu(self.conv2(x)), 2)\n","    x = x.view(-1, self.num_flat_featrues(x))\n","    x = F.relu(self.fc1(x))\n","    x = F.relu(self.fc2(x))\n","    x = self.fc3(x)\n","    return x\n","\n","  def num_flat_featrues(self, x):\n","    size = x.size()[1:]\n","    num_features =  1\n","    for s in size:\n","      num_features *= s\n","    \n","    return num_features\n","  \n","net = Net()\n","print(net)"],"execution_count":28,"outputs":[{"output_type":"stream","text":["Net(\n","  (conv1): Conv2d(1, 6, kernel_size=(3, 3), stride=(1, 1))\n","  (conv2): Conv2d(6, 16, kernel_size=(3, 3), stride=(1, 1))\n","  (fc1): Linear(in_features=400, out_features=120, bias=True)\n","  (fc2): Linear(in_features=120, out_features=84, bias=True)\n","  (fc3): Linear(in_features=84, out_features=10, bias=True)\n",")\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"BndKyGxnSCXK","executionInfo":{"status":"ok","timestamp":1603779435819,"user_tz":-540,"elapsed":50423,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}}},"source":["net = Net().to(device)"],"execution_count":29,"outputs":[]},{"cell_type":"code","metadata":{"id":"aHWkPKpRSxYW","executionInfo":{"status":"ok","timestamp":1603779435820,"user_tz":-540,"elapsed":50421,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}}},"source":["criterion = nn.CrossEntropyLoss()\n","optimizer = optim.SGD(net.parameters(), lr=0.001, momentum=0.9)"],"execution_count":30,"outputs":[]},{"cell_type":"code","metadata":{"id":"-3dCbF7DSxWC","executionInfo":{"status":"ok","timestamp":1603779453965,"user_tz":-540,"elapsed":68557,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"d3f90919-35b7-4bb7-a599-21af14c785d6","colab":{"base_uri":"https://localhost:8080/","height":161}},"source":["for epoch in range(2):\n","  running_loss = 0.0\n","  for i, data in enumerate(train_loader, 0):\n","    inputs, labels = data[0].to(device), data[1].to(device)\n","\n","    optimizer.zero_grad()\n","\n","    outputs = net(inputs)\n","    loss = criterion(outputs, labels)\n","    loss.backward()\n","    optimizer.step()\n","\n","    running_loss += loss.item()\n","    if i % 100 ==99:\n","      print(\"Epoch:{}, Iter:{}, Loss{}\".format(epoch+1, i+1, running_loss /2000))\n","      running_loss = 0.0"],"execution_count":31,"outputs":[{"output_type":"stream","text":["Epoch:1, Iter:100, Loss0.11524820840358733\n","Epoch:1, Iter:200, Loss0.11489891040325165\n","Epoch:1, Iter:300, Loss0.1144956270456314\n","Epoch:1, Iter:400, Loss0.11399297297000885\n","Epoch:2, Iter:100, Loss0.11234906971454621\n","Epoch:2, Iter:200, Loss0.10960202884674072\n","Epoch:2, Iter:300, Loss0.10268861073255539\n","Epoch:2, Iter:400, Loss0.08107531589269638\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"v5-a95lgSxUH","executionInfo":{"status":"ok","timestamp":1603779455215,"user_tz":-540,"elapsed":69800,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"450c646c-40a5-4d72-de78-9bab60412d8a","colab":{"base_uri":"https://localhost:8080/","height":35}},"source":["correct = 0\n","total = 0\n","\n","with torch.no_grad():\n","  for data in test_loader:\n","    images, labels = data[0].to(device), data[1].to(device)\n","    outputs = net(images)\n","    _, predicted = torch.max(outputs.data, 1)\n","    total += labels.size(0)\n","    correct += (predicted == labels).sum().item()\n","\n","  \n","print(100 * correct / total)"],"execution_count":32,"outputs":[{"output_type":"stream","text":["79.34\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"N7Ht8b49DJBG","executionInfo":{"status":"ok","timestamp":1603779455216,"user_tz":-540,"elapsed":69799,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}}},"source":[""],"execution_count":32,"outputs":[]}]}