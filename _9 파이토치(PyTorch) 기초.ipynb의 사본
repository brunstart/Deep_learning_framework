{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"name":"_9 파이토치(PyTorch) 기초.ipynb의 사본","provenance":[{"file_id":"1eHykNLFgidFmMBxKSDF9K5G2hPatXr5G","timestamp":1603365559334}],"collapsed_sections":[]},"kernelspec":{"name":"python3","display_name":"Python 3"},"accelerator":"GPU","widgets":{"application/vnd.jupyter.widget-state+json":{"196c0d0b111b40caa7cf9979beea4f07":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_add36eeca2374a09b06f9d087de1c06b","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_c9d629304aa24fb0b02d89f9f3d529cc","IPY_MODEL_56854687680745378f5640b6c1f374d8"]}},"add36eeca2374a09b06f9d087de1c06b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"c9d629304aa24fb0b02d89f9f3d529cc":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_e8d219007a71416c81a1cccdcf1f39f6","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":1,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_5fba39a8943a4a07b65ad2065e67ef9e"}},"56854687680745378f5640b6c1f374d8":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_fe7fc14943b0401b96dc07fe816e4523","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 9920512/? [00:04&lt;00:00, 2090388.19it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_41c6e3f7786847869f279294c81c4ff7"}},"e8d219007a71416c81a1cccdcf1f39f6":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"5fba39a8943a4a07b65ad2065e67ef9e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"fe7fc14943b0401b96dc07fe816e4523":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"41c6e3f7786847869f279294c81c4ff7":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"3bc494cd83f3499c8fd7dfee406000d6":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_2b4be5875995411cb453fdad5c6fa43d","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_cb008c4534144528b4afd18cbdbd36a6","IPY_MODEL_d2f8f30ac51e48049a68fc7a964b2635"]}},"2b4be5875995411cb453fdad5c6fa43d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"cb008c4534144528b4afd18cbdbd36a6":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_897174e371f445c6b21c4f5adef3898c","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":1,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_b7761fcb65924ac4a11ef18a5d1350f7"}},"d2f8f30ac51e48049a68fc7a964b2635":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_c587b547fa4547cdbee521580347bde6","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 32768/? [00:01&lt;00:00, 22644.96it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_56cfd358e2c04aa3a483639ffaba4c74"}},"897174e371f445c6b21c4f5adef3898c":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"b7761fcb65924ac4a11ef18a5d1350f7":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"c587b547fa4547cdbee521580347bde6":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"56cfd358e2c04aa3a483639ffaba4c74":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"2c3a9c43df4441988e25b1f199f9d573":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_439679226d0c4e2c9e718773d0f0cec2","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_3b9c7c9b67c742ce88957302336872bb","IPY_MODEL_04858037e7d94d9b8adadb45233787c1"]}},"439679226d0c4e2c9e718773d0f0cec2":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"3b9c7c9b67c742ce88957302336872bb":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_eee7cc0cbc704f6babed43e3f193e21d","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":1,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_a54583b4a3f7494a885bf57a129e2a8d"}},"04858037e7d94d9b8adadb45233787c1":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_476abf92ac4b4d209168276ad5050c11","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 1654784/? [00:01&lt;00:00, 1403653.63it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_605bd3e570e14650976b0d9be582d02a"}},"eee7cc0cbc704f6babed43e3f193e21d":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"a54583b4a3f7494a885bf57a129e2a8d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"476abf92ac4b4d209168276ad5050c11":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"605bd3e570e14650976b0d9be582d02a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"1f21f6289c3d4770b1e38e43adfd5726":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_a67c2ae7217e4fe5ac96aca2fc256a48","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_7d5c6d0763154a7aa7c81b1a7eb48147","IPY_MODEL_d9c2e708178f4ad3b275e0e2a0e4c1b5"]}},"a67c2ae7217e4fe5ac96aca2fc256a48":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"7d5c6d0763154a7aa7c81b1a7eb48147":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_3f2d16d6e3a34fd5bed971c1a1577a5d","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":1,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_4bbc199561d54636a9d3752cc4ee4e5a"}},"d9c2e708178f4ad3b275e0e2a0e4c1b5":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_ddd145a6319c49ed9cef8aaa4f0ad5e7","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 8192/? [00:00&lt;00:00, 11477.05it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_7606eb4d4b7e4d43a831f47eb1783c3d"}},"3f2d16d6e3a34fd5bed971c1a1577a5d":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"4bbc199561d54636a9d3752cc4ee4e5a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"ddd145a6319c49ed9cef8aaa4f0ad5e7":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"7606eb4d4b7e4d43a831f47eb1783c3d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}}}}},"cells":[{"cell_type":"markdown","metadata":{"id":"f9Xx-jP92OgP"},"source":["# 파이토치(PyTorch)\n","\n","<img src=\"https://img1.daumcdn.net/thumb/R800x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FbuUgoV%2FbtqwWZvcHHX%2Fd6XzIFBEfiuFb0UvyV4A50%2Fimg.jpg\" width=\"300\">\n","\n","- 코드 출처: https://pytorch.org/tutorials/"]},{"cell_type":"markdown","metadata":{"id":"3cxreguz2sL0"},"source":["## 파이토치의 구성요소\n","\n","- `torch`: 텐서를 생성하는 라이브러리\n","\n","- `torch.autograd`: 자동미분 기능을 제공하는 라이브러리\n","\n","- `torch.nn`: 신경망을 생성하는 라이브러리\n","\n","- `torch.multiprocessing`: 병럴처리 기능을 제공하는 라이브러리\n","\n","- `torch.utils`: 데이터 조작 등 유틸리티 기능 제공\n","\n","- `torch.legacy`(./nn/.optim): Torch로을부터 포팅해온 코드\n","\n","- `torch.onnx`: ONNX(Open Neural Network Exchange)\n","\n","  - 서로 다른 프레임워크 간의 모델 공유할 때 사용"]},{"cell_type":"markdown","metadata":{"id":"gb5O_aSvtHvb"},"source":["## 텐서(Tensors)\n","- 넘파이(NumPy)의 ndarray와 유사\n","\n","- GPU를 사용한 연산 가속도 가능"]},{"cell_type":"code","metadata":{"id":"CmKIvnx0s8G6","executionInfo":{"status":"ok","timestamp":1603774937212,"user_tz":-540,"elapsed":4014,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}}},"source":["import torch"],"execution_count":1,"outputs":[]},{"cell_type":"code","metadata":{"id":"49IHV-qJE5FI","executionInfo":{"status":"ok","timestamp":1603774937214,"user_tz":-540,"elapsed":3698,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"3c83700a-77ea-435d-e4d0-20cb86a2bc9c","colab":{"base_uri":"https://localhost:8080/","height":35}},"source":["torch.__version__"],"execution_count":2,"outputs":[{"output_type":"execute_result","data":{"application/vnd.google.colaboratory.intrinsic+json":{"type":"string"},"text/plain":["'1.6.0+cu101'"]},"metadata":{"tags":[]},"execution_count":2}]},{"cell_type":"markdown","metadata":{"id":"isUHVy-gtZeT"},"source":["### 초기화 되지 않은 행렬 "]},{"cell_type":"code","metadata":{"id":"3PqY3cZatU0D","executionInfo":{"status":"ok","timestamp":1603774937215,"user_tz":-540,"elapsed":3680,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"c1c0df3c-d555-4a5b-98ea-ee22e8cbda68","colab":{"base_uri":"https://localhost:8080/","height":89}},"source":["x = torch.empty(4,2)\n","print(x)"],"execution_count":3,"outputs":[{"output_type":"stream","text":["tensor([[2.6799e-35, 0.0000e+00],\n","        [3.3631e-44, 0.0000e+00],\n","        [       nan, 0.0000e+00],\n","        [1.1578e+27, 1.1362e+30]])\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"zPCIJ2pNteZv"},"source":["### 무작위로 초기화된 행렬"]},{"cell_type":"code","metadata":{"id":"h6oPj2Q9tdYx","executionInfo":{"status":"ok","timestamp":1603774937215,"user_tz":-540,"elapsed":3664,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"920ea2ce-8afe-440f-c36f-5d656d041551","colab":{"base_uri":"https://localhost:8080/","height":89}},"source":["x = torch.rand(4,2)\n","print(x)"],"execution_count":4,"outputs":[{"output_type":"stream","text":["tensor([[0.8729, 0.6122],\n","        [0.4032, 0.9556],\n","        [0.0611, 0.9877],\n","        [0.4158, 0.2002]])\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"A5aHphIHtiJk"},"source":["### dtype이 long, 0으로 채워진 텐서"]},{"cell_type":"code","metadata":{"id":"4zykN8aMthXk","executionInfo":{"status":"ok","timestamp":1603774937914,"user_tz":-540,"elapsed":4340,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"793b91a1-2caa-4519-ed00-c26c3b01937e","colab":{"base_uri":"https://localhost:8080/","height":89}},"source":["x = torch.zeros(4,2, dtype=torch.long)\n","print(x)"],"execution_count":5,"outputs":[{"output_type":"stream","text":["tensor([[0, 0],\n","        [0, 0],\n","        [0, 0],\n","        [0, 0]])\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"W4VL8C_ctu8b","executionInfo":{"status":"ok","timestamp":1603774937915,"user_tz":-540,"elapsed":4299,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"242949a8-4f7c-4a1a-9c83-2874ad195296","colab":{"base_uri":"https://localhost:8080/","height":35}},"source":["x = torch.tensor([3, 2.3])\n","print(x)"],"execution_count":6,"outputs":[{"output_type":"stream","text":["tensor([3.0000, 2.3000])\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"4RmVBVtIt46M","executionInfo":{"status":"ok","timestamp":1603774937915,"user_tz":-540,"elapsed":4270,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"926cdaaa-b1e0-4221-f5b2-dced84c3f3b8","colab":{"base_uri":"https://localhost:8080/","height":53}},"source":["x = x.new_ones(2,4,dtype= torch.double)\n","print(x)"],"execution_count":7,"outputs":[{"output_type":"stream","text":["tensor([[1., 1., 1., 1.],\n","        [1., 1., 1., 1.]], dtype=torch.float64)\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"xxskTUfGuPUe","executionInfo":{"status":"ok","timestamp":1603774937916,"user_tz":-540,"elapsed":4241,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"a5506576-54f5-404e-cd23-654f675057c5","colab":{"base_uri":"https://localhost:8080/","height":53}},"source":["x = torch.randn_like(x, dtype=torch.float)\n","print(x)"],"execution_count":8,"outputs":[{"output_type":"stream","text":["tensor([[ 0.2607,  0.4800,  0.7642, -0.6583],\n","        [-1.0165, -1.2937,  0.0938,  0.4732]])\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"7j5sGxGvucpH"},"source":["### 텐서의 크기"]},{"cell_type":"code","metadata":{"id":"yy-JbqKEuYIR","executionInfo":{"status":"ok","timestamp":1603774937916,"user_tz":-540,"elapsed":4198,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"af22a5b2-6de0-44a2-916c-0e5b86cc9154","colab":{"base_uri":"https://localhost:8080/","height":35}},"source":["print(x.size())"],"execution_count":9,"outputs":[{"output_type":"stream","text":["torch.Size([2, 4])\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"ehOg0eDwufru"},"source":["## 텐서의 연산(operations)"]},{"cell_type":"markdown","metadata":{"id":"j8Doc_37uh3G"},"source":["### 덧셈 1"]},{"cell_type":"code","metadata":{"id":"Rw4JCYkYuef9","executionInfo":{"status":"ok","timestamp":1603774937917,"user_tz":-540,"elapsed":4178,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"31b74126-e69a-43ec-9973-bfb84258b423","colab":{"base_uri":"https://localhost:8080/","height":53}},"source":["print(x)"],"execution_count":10,"outputs":[{"output_type":"stream","text":["tensor([[ 0.2607,  0.4800,  0.7642, -0.6583],\n","        [-1.0165, -1.2937,  0.0938,  0.4732]])\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"Wa44ur1Nuj5U","executionInfo":{"status":"ok","timestamp":1603774937917,"user_tz":-540,"elapsed":4156,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"e08f1951-086f-4d7c-8b39-8853365ce0a1","colab":{"base_uri":"https://localhost:8080/","height":89}},"source":["y = torch.rand(2,4)\n","print(y)\n","print(x + y)"],"execution_count":11,"outputs":[{"output_type":"stream","text":["tensor([[0.7917, 0.0016, 0.0339, 0.6563],\n","        [0.7279, 0.2116, 0.1706, 0.6796]])\n","tensor([[ 1.0523,  0.4816,  0.7981, -0.0020],\n","        [-0.2886, -1.0820,  0.2644,  1.1528]])\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"E5gcOo-Ouo9B"},"source":["### 덧셈2"]},{"cell_type":"code","metadata":{"id":"Qx-NzJhhumZx","executionInfo":{"status":"ok","timestamp":1603774937918,"user_tz":-540,"elapsed":4135,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"2e369ff7-e6a1-49d5-a9f6-8832bf2b1ed4","colab":{"base_uri":"https://localhost:8080/","height":53}},"source":["print(torch.add(x,y))"],"execution_count":12,"outputs":[{"output_type":"stream","text":["tensor([[ 1.0523,  0.4816,  0.7981, -0.0020],\n","        [-0.2886, -1.0820,  0.2644,  1.1528]])\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"RlvrQhLuuuIr"},"source":["### 덧셈3\n","- 결과 텐서를 인자로 제공"]},{"cell_type":"code","metadata":{"id":"lUsLAOTcur1-","executionInfo":{"status":"ok","timestamp":1603774937918,"user_tz":-540,"elapsed":4117,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"9d2ef7cd-da94-4cc1-8fa8-0a6b4ca81449","colab":{"base_uri":"https://localhost:8080/","height":53}},"source":["result = torch.empty(2,4)\n","torch.add(x,y, out=result)\n","print(result)"],"execution_count":13,"outputs":[{"output_type":"stream","text":["tensor([[ 1.0523,  0.4816,  0.7981, -0.0020],\n","        [-0.2886, -1.0820,  0.2644,  1.1528]])\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"V6BdyZFSu2Ei"},"source":["### 덧셈4\n","- `in-place` 방식\n","\n","- (참고) in-place 방식\n","  - in-place방식으로 텐서의 값을 변경하는 연산 뒤에는 _''가 붙음\n","  - `x.copy_(y), x.t_()`"]},{"cell_type":"code","metadata":{"id":"lu8rR4WVu0wQ","executionInfo":{"status":"ok","timestamp":1603774937919,"user_tz":-540,"elapsed":4101,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"db22b73e-ee23-4595-ef37-36bb8ff5a874","colab":{"base_uri":"https://localhost:8080/","height":125}},"source":["print(x)\n","print(y)\n","y.add_(x)\n","print(y)"],"execution_count":14,"outputs":[{"output_type":"stream","text":["tensor([[ 0.2607,  0.4800,  0.7642, -0.6583],\n","        [-1.0165, -1.2937,  0.0938,  0.4732]])\n","tensor([[0.7917, 0.0016, 0.0339, 0.6563],\n","        [0.7279, 0.2116, 0.1706, 0.6796]])\n","tensor([[ 1.0523,  0.4816,  0.7981, -0.0020],\n","        [-0.2886, -1.0820,  0.2644,  1.1528]])\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"Uo8nsrGjOw6W"},"source":["### 그 외의 연산\n","- `torch.sub` : 뺄셈\n","\n","- `torch.mul` : 곱셉\n","\n","- `torch.div` : 나눗셈\n","\n","- `torch.mm` : 내적(dot product)"]},{"cell_type":"code","metadata":{"id":"S51kxzPTO1ER","executionInfo":{"status":"ok","timestamp":1603774937919,"user_tz":-540,"elapsed":4083,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"467d9873-4896-46d4-8977-c8f8009ae2e8","colab":{"base_uri":"https://localhost:8080/","height":125}},"source":["x = torch.Tensor([[1,3,],\n","                  [5,7]])\n","\n","y = torch.Tensor([[2,4],\n","                  [6,8]])\n","\n","print(x - y)\n","print(torch.sub(x,y))\n","print(x.sub_(y))"],"execution_count":15,"outputs":[{"output_type":"stream","text":["tensor([[-1., -1.],\n","        [-1., -1.]])\n","tensor([[-1., -1.],\n","        [-1., -1.]])\n","tensor([[-1., -1.],\n","        [-1., -1.]])\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"ou0dY8mkPR24","executionInfo":{"status":"ok","timestamp":1603774937920,"user_tz":-540,"elapsed":4065,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"bb2f1ba8-fd84-4239-a916-a58d1d37438a","colab":{"base_uri":"https://localhost:8080/","height":125}},"source":["x = torch.Tensor([[1,3,],\n","                  [5,7]])\n","\n","y = torch.Tensor([[2,4],\n","                  [6,8]])\n","\n","print(x * y)\n","print(torch.mul(x,y))\n","print(x.mul_(y))"],"execution_count":16,"outputs":[{"output_type":"stream","text":["tensor([[ 2., 12.],\n","        [30., 56.]])\n","tensor([[ 2., 12.],\n","        [30., 56.]])\n","tensor([[ 2., 12.],\n","        [30., 56.]])\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"6RlZZBp3PbE4","executionInfo":{"status":"ok","timestamp":1603774937920,"user_tz":-540,"elapsed":4039,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"f2750e51-d837-4b87-da57-56ad32310818","colab":{"base_uri":"https://localhost:8080/","height":125}},"source":["x = torch.Tensor([[1,3,],\n","                  [5,7]])\n","\n","y = torch.Tensor([[2,4],\n","                  [6,8]])\n","\n","print(x / y)\n","print(torch.div(x,y))\n","print(x.div_(y))"],"execution_count":17,"outputs":[{"output_type":"stream","text":["tensor([[0.5000, 0.7500],\n","        [0.8333, 0.8750]])\n","tensor([[0.5000, 0.7500],\n","        [0.8333, 0.8750]])\n","tensor([[0.5000, 0.7500],\n","        [0.8333, 0.8750]])\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"7MR-ofE5P7VC","executionInfo":{"status":"ok","timestamp":1603774937922,"user_tz":-540,"elapsed":4022,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"ab7e9dc2-fcb2-4ec2-bce1-b737bd797146","colab":{"base_uri":"https://localhost:8080/","height":53}},"source":["x = torch.Tensor([[1,3,],\n","                  [5,7]])\n","\n","y = torch.Tensor([[2,4],\n","                  [6,8]])\n","\n","print(torch.mm(x,y))\n"],"execution_count":18,"outputs":[{"output_type":"stream","text":["tensor([[20., 28.],\n","        [52., 76.]])\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"8URGwHE_NjDi"},"source":["## 텐서의 조작(manipulations)"]},{"cell_type":"markdown","metadata":{"id":"uCsdZIPTvG53"},"source":["### 인덱싱\n","- 넘파이처럼 인덱싱 사용가능"]},{"cell_type":"code","metadata":{"id":"jF2DE8kzvOs3","executionInfo":{"status":"ok","timestamp":1603774937923,"user_tz":-540,"elapsed":4008,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"b1b96623-1e00-46b9-bb29-fad520a1d8da","colab":{"base_uri":"https://localhost:8080/","height":53}},"source":["print(x)"],"execution_count":19,"outputs":[{"output_type":"stream","text":["tensor([[1., 3.],\n","        [5., 7.]])\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"GQtBH3r3u7c3","executionInfo":{"status":"ok","timestamp":1603774937924,"user_tz":-540,"elapsed":3992,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"44528b87-dd83-49b2-d432-e45e4faa53ae","colab":{"base_uri":"https://localhost:8080/","height":35}},"source":["print(x[:, 1])"],"execution_count":20,"outputs":[{"output_type":"stream","text":["tensor([3., 7.])\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"jEscXddKvQ5l"},"source":["### view\n","- 텐서의 크기(size)나 모양(shape)을 변경"]},{"cell_type":"code","metadata":{"id":"xwhWeqhLvKKj","executionInfo":{"status":"ok","timestamp":1603774937925,"user_tz":-540,"elapsed":3978,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"61aa84f0-d6db-4afe-abd3-db2546096827","colab":{"base_uri":"https://localhost:8080/","height":287}},"source":["x = torch.randn(4,5)\n","\n","y = x.view(20)\n","z = x.view(5, -1)\n","\n","print(x)\n","print(y)\n","print(z)\n","\n","\n","print(x.size())\n","print(y.size())\n","print(z.size())"],"execution_count":21,"outputs":[{"output_type":"stream","text":["tensor([[ 0.6723,  0.2146, -0.6601, -0.8776,  0.3856],\n","        [ 0.6353,  0.3962,  0.9099, -0.6168,  0.0443],\n","        [ 0.2119,  1.4987, -0.7054, -0.4891,  0.0229],\n","        [-0.6405, -0.2710, -0.5711, -1.3986,  0.0567]])\n","tensor([ 0.6723,  0.2146, -0.6601, -0.8776,  0.3856,  0.6353,  0.3962,  0.9099,\n","        -0.6168,  0.0443,  0.2119,  1.4987, -0.7054, -0.4891,  0.0229, -0.6405,\n","        -0.2710, -0.5711, -1.3986,  0.0567])\n","tensor([[ 0.6723,  0.2146, -0.6601, -0.8776],\n","        [ 0.3856,  0.6353,  0.3962,  0.9099],\n","        [-0.6168,  0.0443,  0.2119,  1.4987],\n","        [-0.7054, -0.4891,  0.0229, -0.6405],\n","        [-0.2710, -0.5711, -1.3986,  0.0567]])\n","torch.Size([4, 5])\n","torch.Size([20])\n","torch.Size([5, 4])\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"iBY_wuIRvf5j"},"source":["### item\n","- 텐서에 값이 단 하나라도 존재하면 숫자값을 얻을 수 있음\n"]},{"cell_type":"code","metadata":{"id":"E0W24QqpvcmV","executionInfo":{"status":"ok","timestamp":1603774937926,"user_tz":-540,"elapsed":3965,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"dfcb34ba-9d03-4730-a2d9-5486d1f1d3c8","colab":{"base_uri":"https://localhost:8080/","height":71}},"source":["x=  torch.randn(1)\n","\n","print(x)\n","\n","print(x.item())\n","print(x.dtype)"],"execution_count":22,"outputs":[{"output_type":"stream","text":["tensor([0.9407])\n","0.9407315850257874\n","torch.float32\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"V1sCUVwC3Nua"},"source":["- 스칼라값 하나만 존재해야함"]},{"cell_type":"code","metadata":{"id":"jl4_FAgd3Lt9","executionInfo":{"status":"error","timestamp":1603774963120,"user_tz":-540,"elapsed":1805,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"45e799bc-4763-486b-bb0e-388c57bb5134","colab":{"base_uri":"https://localhost:8080/","height":244}},"source":["x=  torch.randn(2)\n","\n","print(x)\n","\n","print(x.item())\n","print(x.dtype)"],"execution_count":24,"outputs":[{"output_type":"stream","text":["tensor([0.6143, 1.0987])\n"],"name":"stdout"},{"output_type":"error","ename":"ValueError","evalue":"ignored","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mValueError\u001b[0m                                Traceback (most recent call last)","\u001b[0;32m<ipython-input-24-cc6c8677be41>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m()\u001b[0m\n\u001b[1;32m      3\u001b[0m \u001b[0mprint\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mx\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      4\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m----> 5\u001b[0;31m \u001b[0mprint\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mx\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mitem\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m      6\u001b[0m \u001b[0mprint\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mx\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mdtype\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;31mValueError\u001b[0m: only one element tensors can be converted to Python scalars"]}]},{"cell_type":"markdown","metadata":{"id":"uThndsy5M6wM"},"source":["### squeeze \n","- 차원을 축소(제거)"]},{"cell_type":"code","metadata":{"id":"OF3rOavnRxgM","executionInfo":{"status":"ok","timestamp":1603774964126,"user_tz":-540,"elapsed":2790,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"c4b6a1c1-1da0-4c92-d51c-fcba5fc91daa","colab":{"base_uri":"https://localhost:8080/","height":89}},"source":["tensor = torch.rand(1,3,3)\n","print(tensor)\n","tensor.shape\n"],"execution_count":25,"outputs":[{"output_type":"stream","text":["tensor([[[0.9701, 0.0410, 0.6251],\n","         [0.2989, 0.6736, 0.0780],\n","         [0.0401, 0.2651, 0.5516]]])\n"],"name":"stdout"},{"output_type":"execute_result","data":{"text/plain":["torch.Size([1, 3, 3])"]},"metadata":{"tags":[]},"execution_count":25}]},{"cell_type":"code","metadata":{"id":"Y2jq0jHJR5Jw","executionInfo":{"status":"ok","timestamp":1603774964127,"user_tz":-540,"elapsed":2778,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"336f6235-62aa-485b-8dcb-6e5e2cd6d1fc","colab":{"base_uri":"https://localhost:8080/","height":89}},"source":["t = tensor.squeeze()\n","\n","print(t)\n","print(t.shape)"],"execution_count":26,"outputs":[{"output_type":"stream","text":["tensor([[0.9701, 0.0410, 0.6251],\n","        [0.2989, 0.6736, 0.0780],\n","        [0.0401, 0.2651, 0.5516]])\n","torch.Size([3, 3])\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"COv-dnTYNJ8Z"},"source":["### unsqueeze\n","- 차원을 증가(생성)"]},{"cell_type":"code","metadata":{"id":"PFxaHGY1NOBo","executionInfo":{"status":"ok","timestamp":1603774964128,"user_tz":-540,"elapsed":2763,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"b4f4706c-64f0-4d6c-e6c6-36a596de88a2","colab":{"base_uri":"https://localhost:8080/","height":89}},"source":["tensor = torch.rand(1,3,3)\n","print(tensor)\n","tensor.shape\n"],"execution_count":27,"outputs":[{"output_type":"stream","text":["tensor([[[0.0620, 0.9175, 0.5609],\n","         [0.7901, 0.2430, 0.6657],\n","         [0.4224, 0.6756, 0.3206]]])\n"],"name":"stdout"},{"output_type":"execute_result","data":{"text/plain":["torch.Size([1, 3, 3])"]},"metadata":{"tags":[]},"execution_count":27}]},{"cell_type":"code","metadata":{"id":"b6sa4tJ7SA8G","executionInfo":{"status":"ok","timestamp":1603774964128,"user_tz":-540,"elapsed":2751,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"407f11da-1004-4a41-99d9-b59fa40b0806","colab":{"base_uri":"https://localhost:8080/","height":89}},"source":["t = tensor.unsqueeze(dim=0)\n","\n","print(t)\n","print(t.shape)"],"execution_count":28,"outputs":[{"output_type":"stream","text":["tensor([[[[0.0620, 0.9175, 0.5609],\n","          [0.7901, 0.2430, 0.6657],\n","          [0.4224, 0.6756, 0.3206]]]])\n","torch.Size([1, 1, 3, 3])\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"_C_oa9JANOa6"},"source":["### stack\n","- 텐서간 결합"]},{"cell_type":"code","metadata":{"id":"f3x_XaUYNOuc","executionInfo":{"status":"ok","timestamp":1603774964129,"user_tz":-540,"elapsed":2743,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"cd4b3276-d385-4c23-8a44-da038d399a12","colab":{"base_uri":"https://localhost:8080/","height":71}},"source":["x = torch.FloatTensor([1, 4])\n","y = torch.FloatTensor([2, 5])\n","z = torch.FloatTensor([3, 6])\n","\n","print(torch.stack([x,y,z]))"],"execution_count":29,"outputs":[{"output_type":"stream","text":["tensor([[1., 4.],\n","        [2., 5.],\n","        [3., 6.]])\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"XmJscbfg35-c"},"source":["### cat\n","- 텐서를 결합하는 메소드(concatenate)\n","\n","- 넘파이의 `stack`과 유사하지만, 쌓을 dim이 존재해야함\n","  - 예를 들어, 해당 차원을 늘려준 후 결합\n"]},{"cell_type":"code","metadata":{"id":"Mv3zlaNm37P1","executionInfo":{"status":"ok","timestamp":1603774964130,"user_tz":-540,"elapsed":2732,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"52e28d28-9a8c-4d24-9243-1e6f344ff6a8","colab":{"base_uri":"https://localhost:8080/","height":179}},"source":["a = torch.randn(1,1,3,3)\n","b = torch.randn(1,1,3,3)\n","c = torch.cat((a,b), dim=0)\n","\n","print(c)\n","print(c.size())"],"execution_count":30,"outputs":[{"output_type":"stream","text":["tensor([[[[-0.0326, -0.2203, -0.7204],\n","          [ 0.5206, -0.2284, -0.9402],\n","          [-0.0499, -0.6483,  0.7411]]],\n","\n","\n","        [[[ 0.0475, -2.0092,  2.3381],\n","          [ 0.1328,  1.9164,  0.3068],\n","          [ 0.5758, -0.3071, -0.5044]]]])\n","torch.Size([2, 1, 3, 3])\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"69M5jY60S7Mi","executionInfo":{"status":"ok","timestamp":1603774964131,"user_tz":-540,"elapsed":2723,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"aa09ce8f-dd2e-48d9-a363-1fdd2c99711e","colab":{"base_uri":"https://localhost:8080/","height":89}},"source":["a = torch.randn(1,3,3)\n","b = torch.randn(1,3,3)\n","c = torch.cat((a,b), dim=2)\n","\n","\n","print(c)\n","print(c.size())"],"execution_count":31,"outputs":[{"output_type":"stream","text":["tensor([[[ 1.7341,  1.3395, -0.9319,  0.3837,  0.5459, -0.4710],\n","         [ 0.3877, -2.0899, -0.3622, -0.1781, -1.2779,  0.3331],\n","         [ 1.2069,  0.5174,  0.8075, -0.8212,  0.1835,  2.1033]]])\n","torch.Size([1, 3, 6])\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"7gGXnOAqQTmG"},"source":["### chuck\n","- 텐서를 여러 개로 나눌 때 사용\n","\n","- 몇 개의 텐서로 나눌 것이냐"]},{"cell_type":"code","metadata":{"id":"pNV80VzPQZgG","executionInfo":{"status":"ok","timestamp":1603774964132,"user_tz":-540,"elapsed":2712,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"97075c59-734a-4374-f544-489c54cc66d1","colab":{"base_uri":"https://localhost:8080/","height":233}},"source":["tensor = torch.rand(3,6)\n","t1, t2, t3 = torch.chunk(tensor, 3, dim=1)\n","\n","print(tensor)\n","print(t1)\n","print(t2)\n","print(t3)"],"execution_count":32,"outputs":[{"output_type":"stream","text":["tensor([[0.1136, 0.6597, 0.4358, 0.0903, 0.7777, 0.5859],\n","        [0.5099, 0.9041, 0.2346, 0.9985, 0.6390, 0.2206],\n","        [0.6839, 0.9661, 0.8497, 0.6446, 0.2555, 0.3275]])\n","tensor([[0.1136, 0.6597],\n","        [0.5099, 0.9041],\n","        [0.6839, 0.9661]])\n","tensor([[0.4358, 0.0903],\n","        [0.2346, 0.9985],\n","        [0.8497, 0.6446]])\n","tensor([[0.7777, 0.5859],\n","        [0.6390, 0.2206],\n","        [0.2555, 0.3275]])\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"7U0Qb0jWQgm-"},"source":["### split\n","- `chunck`와 동일한 기능이지만 조금 다름\n","\n","- 하나의 텐서당 크기가 얼마이냐"]},{"cell_type":"code","metadata":{"id":"1V6DDnLVQqxz","executionInfo":{"status":"ok","timestamp":1603774964132,"user_tz":-540,"elapsed":2700,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"e6d7acb1-73f3-4cb7-c19c-eaf94cbef88e","colab":{"base_uri":"https://localhost:8080/","height":179}},"source":["tensor = torch.rand(3,6)\n","t1, t2 = torch.split(tensor, 3, dim=1)\n","\n","print(tensor)\n","print(t1)\n","print(t2)"],"execution_count":33,"outputs":[{"output_type":"stream","text":["tensor([[0.1086, 0.0307, 0.2247, 0.9792, 0.6743, 0.9518],\n","        [0.2572, 0.6174, 0.8954, 0.6828, 0.6090, 0.6932],\n","        [0.8021, 0.8472, 0.9002, 0.8780, 0.8944, 0.4000]])\n","tensor([[0.1086, 0.0307, 0.2247],\n","        [0.2572, 0.6174, 0.8954],\n","        [0.8021, 0.8472, 0.9002]])\n","tensor([[0.9792, 0.6743, 0.9518],\n","        [0.6828, 0.6090, 0.6932],\n","        [0.8780, 0.8944, 0.4000]])\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"estSwhCgvta6"},"source":["### torch ↔ numpy\n","- Torch Tensor(텐서)를 Numpy array(배열)로 변환 가능\n","\n","  - `numpy()`\n","  - `from_numpy()`\n","\n","- (참고)\n","  - Tensor가 CPU상에 있다면 Numpy 배열은 메모리 공간을 공유하므로 하나가 변하면, 다른 하나도 변함"]},{"cell_type":"code","metadata":{"id":"VxHI7c_yvmAT","executionInfo":{"status":"ok","timestamp":1603774964133,"user_tz":-540,"elapsed":2669,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"09e24ae7-c952-4b07-b3d2-c8e6c623fea7","colab":{"base_uri":"https://localhost:8080/","height":35}},"source":["a = torch.ones(7)\n","print(a)"],"execution_count":34,"outputs":[{"output_type":"stream","text":["tensor([1., 1., 1., 1., 1., 1., 1.])\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"whbrhokHwJ3A","executionInfo":{"status":"ok","timestamp":1603774964133,"user_tz":-540,"elapsed":2657,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"9d430c47-7496-4535-de8c-a99b3e2388d0","colab":{"base_uri":"https://localhost:8080/","height":35}},"source":["b = a.numpy()\n","print(b)"],"execution_count":35,"outputs":[{"output_type":"stream","text":["[1. 1. 1. 1. 1. 1. 1.]\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"5StIhUWDwQjA","executionInfo":{"status":"ok","timestamp":1603774964134,"user_tz":-540,"elapsed":2649,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"92fa8a4b-7478-41c3-c0a8-3f0043e6e010","colab":{"base_uri":"https://localhost:8080/","height":53}},"source":["a.add_(1)\n","print(a)\n","print(b)"],"execution_count":36,"outputs":[{"output_type":"stream","text":["tensor([2., 2., 2., 2., 2., 2., 2.])\n","[2. 2. 2. 2. 2. 2. 2.]\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"3RNS5-cRwTt8","executionInfo":{"status":"ok","timestamp":1603774964134,"user_tz":-540,"elapsed":2641,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"b9d83f46-dc2e-44c7-a118-4f6206da5e9e","colab":{"base_uri":"https://localhost:8080/","height":53}},"source":["import numpy as np\n","\n","a= np.ones(7)\n","b = torch.from_numpy(a)\n","np.add(a, 1, out=a)\n","print(a)\n","print(b)"],"execution_count":37,"outputs":[{"output_type":"stream","text":["[2. 2. 2. 2. 2. 2. 2.]\n","tensor([2., 2., 2., 2., 2., 2., 2.], dtype=torch.float64)\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"v-ZaxSvLxEej"},"source":["## CUDA Tensors\n","- `.to` 메소드를 사용하여 텐서를 어떠한 장치로도 옮길 수 있음\n","  - 예) cpu, gpu"]},{"cell_type":"code","metadata":{"id":"xkaQznCRxpUj","executionInfo":{"status":"ok","timestamp":1603774964135,"user_tz":-540,"elapsed":2633,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}}},"source":["import torch"],"execution_count":38,"outputs":[]},{"cell_type":"code","metadata":{"id":"SCnC0x2Rxpbk","executionInfo":{"status":"ok","timestamp":1603774964135,"user_tz":-540,"elapsed":2618,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"36d6f0e0-c5e4-474e-8a10-57768e24ff22","colab":{"base_uri":"https://localhost:8080/","height":71}},"source":["x = torch.randn(1)\n","print(x)\n","print(x.item())\n","print(x.dtype)"],"execution_count":39,"outputs":[{"output_type":"stream","text":["tensor([-0.6113])\n","-0.6112757325172424\n","torch.float32\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"GcSsFLkDw-nI","executionInfo":{"status":"ok","timestamp":1603774974235,"user_tz":-540,"elapsed":12707,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"b1ad785a-9f94-476b-f526-cb91a1bff1e9","colab":{"base_uri":"https://localhost:8080/","height":71}},"source":["device = torch.device(\"cuda\" if torch.cuda.is_available() else \"cpu\")\n","\n","y =torch.ones_like(x, device=device)\n","x = x.to(device)\n","z = x + y\n","print(device)\n","print(z)\n","print(z.to(\"cpu\", torch.double))"],"execution_count":40,"outputs":[{"output_type":"stream","text":["cuda\n","tensor([0.3887], device='cuda:0')\n","tensor([0.3887], dtype=torch.float64)\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"NKqiGvLWx2nk"},"source":["## AUTOGRAD (자동미분)\n","- autograd 패키지는 Tensor의 모든 연산에 대해 **자동 미분** 제공\n","\n","- 이는 코드를 어떻게 작성하여 실행하느냐에 따라 역전파가 정의된다는 뜻\n","\n","- backprop를 위한 미분값을 자동으로 계산"]},{"cell_type":"markdown","metadata":{"id":"0zH41l-MyMHi"},"source":["### Tensor\n","\n","- data: tensor형태의 데이터\n","\n","- grad: data가 겨쳐온 layer에 대한 미분값 저장\n","\n","- grad_fn: 미분값을 계산한 함수에 대한 정보 저장 (어떤 함수에 대해서 backprop 했는지)\n","\n","- `requires_grad` 속성을 `True`로 설정하면, 해당 텐서에서 이루어지는 모든 연산들을 추적하기 시작\n","\n","- 계산이 완료된 후, `.backward()`를 호출하면 자동으로 `gradient`를 계산할 수 있으며, `.grad` 속성에 누적됨\n","\n","- 기록을 추적하는 것을 중단하게 하려면, `.detach()`를 호출하여 연산기록으로부터 분리\n","\n","- 기록을 추적하는 것을 방지하기 위해 코드 블럭을 `with torch.no_grad():`로 감싸면 `gradient`는 필요없지만, `requires_grad=True`로 설정되어 학습 가능한 매개변수를 갖는 모델을 평가(evaluate)할 때 유용\n","\n","- Autograd 구현에서 매우 중요한 클래스 : `Function` 클래스"]},{"cell_type":"code","metadata":{"id":"ipdk_1jfx47I","executionInfo":{"status":"ok","timestamp":1603774974236,"user_tz":-540,"elapsed":12699,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}}},"source":["import torch"],"execution_count":41,"outputs":[]},{"cell_type":"code","metadata":{"id":"ljNU-r9p0Rpo","executionInfo":{"status":"ok","timestamp":1603774974237,"user_tz":-540,"elapsed":12687,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"dceb421f-1259-4265-c240-7844119a4ec8","colab":{"base_uri":"https://localhost:8080/","height":71}},"source":["x=  torch.ones(3, 3, requires_grad=True)\n","print(x)"],"execution_count":42,"outputs":[{"output_type":"stream","text":["tensor([[1., 1., 1.],\n","        [1., 1., 1.],\n","        [1., 1., 1.]], requires_grad=True)\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"or6sQ4EB0UYz","executionInfo":{"status":"ok","timestamp":1603774974237,"user_tz":-540,"elapsed":12678,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"2fcf6c38-3905-4bea-f48a-644b86c8bc4f","colab":{"base_uri":"https://localhost:8080/","height":71}},"source":["y = x +5\n","print(y)"],"execution_count":43,"outputs":[{"output_type":"stream","text":["tensor([[6., 6., 6.],\n","        [6., 6., 6.],\n","        [6., 6., 6.]], grad_fn=<AddBackward0>)\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"PuQ7xDmu0Wpj","executionInfo":{"status":"ok","timestamp":1603774974238,"user_tz":-540,"elapsed":12664,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"fae09a0e-66f9-4afb-d1c1-cc3d5750774d","colab":{"base_uri":"https://localhost:8080/","height":35}},"source":["print(y.grad_fn)"],"execution_count":44,"outputs":[{"output_type":"stream","text":["<AddBackward0 object at 0x7fe3026945f8>\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"6_2iM-Zq0ZdG","executionInfo":{"status":"ok","timestamp":1603774974239,"user_tz":-540,"elapsed":12644,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"008aef01-e748-44b9-d481-700765af0d0e","colab":{"base_uri":"https://localhost:8080/","height":71}},"source":["z = y * y * 2\n","out = z.mean()\n","\n","print(z, out)"],"execution_count":45,"outputs":[{"output_type":"stream","text":["tensor([[72., 72., 72.],\n","        [72., 72., 72.],\n","        [72., 72., 72.]], grad_fn=<MulBackward0>) tensor(72., grad_fn=<MeanBackward0>)\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"2aZ8SWn_0nqt"},"source":["- `requires_grad_(...)`는 기존 텐서의 `requires_grad`값을 바꿔치기(`in-place`)하여 변경"]},{"cell_type":"code","metadata":{"id":"mHGROgrM0ebO","executionInfo":{"status":"ok","timestamp":1603774974239,"user_tz":-540,"elapsed":12633,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"0d6711cb-b731-4ca5-aa45-eca65c4bc622","colab":{"base_uri":"https://localhost:8080/","height":71}},"source":["a = torch.randn(3,3)\n","a = ((a * 3) / (a -1))\n","print(a.requires_grad)\n","\n","a.requires_grad_(True)\n","print(a.requires_grad)\n","\n","b = (a*a).sum()\n","print(b.grad_fn)"],"execution_count":46,"outputs":[{"output_type":"stream","text":["False\n","True\n","<SumBackward0 object at 0x7fe3026ae748>\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"KiEn_stZ1VgU"},"source":["### 기울기(Gradient)\n","- 역전파: `.backward()`를 통해 역전파 계산 가능"]},{"cell_type":"code","metadata":{"id":"1tdoN9p-1kn4","executionInfo":{"status":"ok","timestamp":1603774974239,"user_tz":-540,"elapsed":12620,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}}},"source":["out.backward()"],"execution_count":47,"outputs":[]},{"cell_type":"code","metadata":{"id":"CixGTXbV1B9p","executionInfo":{"status":"ok","timestamp":1603774974240,"user_tz":-540,"elapsed":12612,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"201306d7-abc3-4bfd-d9ea-d4fa9c9eed92","colab":{"base_uri":"https://localhost:8080/","height":71}},"source":["print(x.grad)"],"execution_count":48,"outputs":[{"output_type":"stream","text":["tensor([[2.6667, 2.6667, 2.6667],\n","        [2.6667, 2.6667, 2.6667],\n","        [2.6667, 2.6667, 2.6667]])\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"SY63Mcc-1iNI","executionInfo":{"status":"ok","timestamp":1603774974240,"user_tz":-540,"elapsed":12600,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"adfba8ee-a960-4aa5-dc37-ecdd175117af","colab":{"base_uri":"https://localhost:8080/","height":35}},"source":["x = torch.randn(3, requires_grad=True)\n","\n","y = x * 2\n","while y.data.norm() <1000:\n","  y = y*2\n","\n","print(y)"],"execution_count":49,"outputs":[{"output_type":"stream","text":["tensor([-1123.2992,  -748.9589,  -201.8008], grad_fn=<MulBackward0>)\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"YPaVAbIT3gx_","executionInfo":{"status":"ok","timestamp":1603774974241,"user_tz":-540,"elapsed":12583,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"afc8c8bf-7504-4464-9606-74acd1c6630d","colab":{"base_uri":"https://localhost:8080/","height":35}},"source":["v = torch.tensor([0.1, 1.0, 0.0001], dtype=torch.float)\n","y.backward(v)\n","\n","print(x.grad)"],"execution_count":50,"outputs":[{"output_type":"stream","text":["tensor([5.1200e+01, 5.1200e+02, 5.1200e-02])\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"0b9amArPXtcX"},"source":["- `with torch.no_grad()`를 사용하여 gradient의 업데이트를 하지 않음"]},{"cell_type":"code","metadata":{"id":"weeIe5_Z3jVe","executionInfo":{"status":"ok","timestamp":1603774974241,"user_tz":-540,"elapsed":12573,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"82315278-75e9-413d-ea2d-8a6acb709688","colab":{"base_uri":"https://localhost:8080/","height":71}},"source":["print(x.requires_grad)\n","print((x**2).requires_grad)\n","\n","with torch.no_grad():\n","  print((x**2).requires_grad)"],"execution_count":51,"outputs":[{"output_type":"stream","text":["True\n","True\n","False\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"bLcTLVRSmCdH"},"source":["- `detach()`: 내용물(content)은 같지만 require_grad가 다른 새로운 Tensor를 가져올 때"]},{"cell_type":"code","metadata":{"id":"ALcth7Ew3l7H","executionInfo":{"status":"ok","timestamp":1603774974242,"user_tz":-540,"elapsed":12563,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"4d3c7e5a-9448-4365-aba0-da385dc29cc7","colab":{"base_uri":"https://localhost:8080/","height":71}},"source":["print(x.requires_grad)\n","y = x.detach()\n","print(y.requires_grad)\n","print(x.eq(y).all())"],"execution_count":52,"outputs":[{"output_type":"stream","text":["True\n","False\n","tensor(True)\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"NSarysrqBh9D"},"source":["### 자동 미분 흐름 다시 보기(1)\n","- 계산 흐름  \n","  $a \\rightarrow b  \\rightarrow c  \\rightarrow out $\n","\n","<br>\n","\n","## $\\quad \\frac{\\partial out}{\\partial a} = ?$\n","- `backward()`를 통해  \n","  $a \\leftarrow b  \\leftarrow c  \\leftarrow out $을 계산하면  \n","    $\\frac{\\partial out}{\\partial a}$값이 `a.grad`에 채워짐\n"]},{"cell_type":"code","metadata":{"id":"NUAc1etP3oBc","executionInfo":{"status":"ok","timestamp":1603774974242,"user_tz":-540,"elapsed":12551,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}}},"source":["import torch"],"execution_count":53,"outputs":[]},{"cell_type":"code","metadata":{"id":"tCW7dq9uB89T","executionInfo":{"status":"ok","timestamp":1603774974242,"user_tz":-540,"elapsed":12541,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"2cc40df6-4214-4f78-e894-5274623b5e1c","colab":{"base_uri":"https://localhost:8080/","height":53}},"source":["a  = torch.ones(2,2)\n","print(a)"],"execution_count":54,"outputs":[{"output_type":"stream","text":["tensor([[1., 1.],\n","        [1., 1.]])\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"-AyyGy49FLz9","executionInfo":{"status":"ok","timestamp":1603774974243,"user_tz":-540,"elapsed":12532,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"392d7a77-8bd5-4c9e-ceed-a4b3e91b711d","colab":{"base_uri":"https://localhost:8080/","height":53}},"source":["a = torch.ones(2,2, requires_grad=True)\n","print(a)"],"execution_count":55,"outputs":[{"output_type":"stream","text":["tensor([[1., 1.],\n","        [1., 1.]], requires_grad=True)\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"SmmJa-hvFPGH","executionInfo":{"status":"ok","timestamp":1603774974243,"user_tz":-540,"elapsed":12519,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"9a7c895b-3ac1-4aee-bf61-e11e736d146a","colab":{"base_uri":"https://localhost:8080/","height":89}},"source":["print(\"a.data:\", a.data)\n","print(\"a.grad\", a.grad)\n","print(\"a.grad_fn\", a.grad_fn)"],"execution_count":56,"outputs":[{"output_type":"stream","text":["a.data: tensor([[1., 1.],\n","        [1., 1.]])\n","a.grad None\n","a.grad_fn None\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"BCwhTsiHGCmG"},"source":["- $b = a + 2$"]},{"cell_type":"code","metadata":{"id":"iUPt042iF9V1","executionInfo":{"status":"ok","timestamp":1603774974244,"user_tz":-540,"elapsed":12508,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"6379657e-7cb2-4a94-d560-991ca44fde94","colab":{"base_uri":"https://localhost:8080/","height":53}},"source":["b = a + 2\n","print(b)"],"execution_count":57,"outputs":[{"output_type":"stream","text":["tensor([[3., 3.],\n","        [3., 3.]], grad_fn=<AddBackward0>)\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"6cw2zoq9GHLF"},"source":["- $c = b^2$ "]},{"cell_type":"code","metadata":{"id":"FRDS6gP0GFZG","executionInfo":{"status":"ok","timestamp":1603774974245,"user_tz":-540,"elapsed":12498,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"1a4e84ed-5b59-44c5-8841-47d1c625afda","colab":{"base_uri":"https://localhost:8080/","height":53}},"source":["c = b**2\n","print(c)"],"execution_count":58,"outputs":[{"output_type":"stream","text":["tensor([[9., 9.],\n","        [9., 9.]], grad_fn=<PowBackward0>)\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"VynoiUywGSwh","executionInfo":{"status":"ok","timestamp":1603774974245,"user_tz":-540,"elapsed":12486,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"3954e826-a5fe-4d0c-c154-b6f34850d1a2","colab":{"base_uri":"https://localhost:8080/","height":35}},"source":["out = c.sum()\n","print(out)"],"execution_count":59,"outputs":[{"output_type":"stream","text":["tensor(36., grad_fn=<SumBackward0>)\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"v3ryJon9GeMn","executionInfo":{"status":"ok","timestamp":1603774974246,"user_tz":-540,"elapsed":12477,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"441db017-5a36-4c16-d573-7f9a53387d04","colab":{"base_uri":"https://localhost:8080/","height":35}},"source":["print(out)\n","out.backward()"],"execution_count":60,"outputs":[{"output_type":"stream","text":["tensor(36., grad_fn=<SumBackward0>)\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"f0aoNsPDHsoG"},"source":["- a의 `grad_fn`이 None인 이유  \n","  직접적으로 계산한 부분이 없었기 때문"]},{"cell_type":"code","metadata":{"id":"bccI4vIWGgqj","executionInfo":{"status":"ok","timestamp":1603774974246,"user_tz":-540,"elapsed":12467,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"3f1cd1d4-6405-4060-f04d-c04e954ea973","colab":{"base_uri":"https://localhost:8080/","height":107}},"source":["print(\"a.data:\", a.data)\n","print(\"a.grad\", a.grad)\n","print(\"a.grad_fn\", a.grad_fn)"],"execution_count":61,"outputs":[{"output_type":"stream","text":["a.data: tensor([[1., 1.],\n","        [1., 1.]])\n","a.grad tensor([[6., 6.],\n","        [6., 6.]])\n","a.grad_fn None\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"oka1mkadHq-N","executionInfo":{"status":"ok","timestamp":1603774974246,"user_tz":-540,"elapsed":12453,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"bf407457-96a5-4363-98e3-74219d5d9d21","colab":{"base_uri":"https://localhost:8080/","height":145}},"source":["print(\"b.data:\", b.data)\n","print(\"b.grad\", b.grad)\n","print(\"b.grad_fn\", b.grad_fn)"],"execution_count":62,"outputs":[{"output_type":"stream","text":["b.data: tensor([[3., 3.],\n","        [3., 3.]])\n","b.grad None\n","b.grad_fn <AddBackward0 object at 0x7fe3026aeef0>\n"],"name":"stdout"},{"output_type":"stream","text":["/usr/local/lib/python3.6/dist-packages/ipykernel_launcher.py:2: UserWarning: The .grad attribute of a Tensor that is not a leaf Tensor is being accessed. Its .grad attribute won't be populated during autograd.backward(). If you indeed want the gradient for a non-leaf Tensor, use .retain_grad() on the non-leaf Tensor. If you access the non-leaf Tensor by mistake, make sure you access the leaf Tensor instead. See github.com/pytorch/pytorch/pull/30531 for more informations.\n","  \n"],"name":"stderr"}]},{"cell_type":"code","metadata":{"id":"ZiYNajdLccUF","executionInfo":{"status":"ok","timestamp":1603774974247,"user_tz":-540,"elapsed":12442,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"b2df9177-6058-4a0d-e703-aed4b761cd82","colab":{"base_uri":"https://localhost:8080/","height":145}},"source":["print(\"c.data:\", c.data)\n","print(\"c.grad\", c.grad)\n","print(\"c.grad_fn\", c.grad_fn)"],"execution_count":63,"outputs":[{"output_type":"stream","text":["c.data: tensor([[9., 9.],\n","        [9., 9.]])\n","c.grad None\n","c.grad_fn <PowBackward0 object at 0x7fe3026aef98>\n"],"name":"stdout"},{"output_type":"stream","text":["/usr/local/lib/python3.6/dist-packages/ipykernel_launcher.py:2: UserWarning: The .grad attribute of a Tensor that is not a leaf Tensor is being accessed. Its .grad attribute won't be populated during autograd.backward(). If you indeed want the gradient for a non-leaf Tensor, use .retain_grad() on the non-leaf Tensor. If you access the non-leaf Tensor by mistake, make sure you access the leaf Tensor instead. See github.com/pytorch/pytorch/pull/30531 for more informations.\n","  \n"],"name":"stderr"}]},{"cell_type":"code","metadata":{"id":"BcLoMYite0vU","executionInfo":{"status":"ok","timestamp":1603774974779,"user_tz":-540,"elapsed":12964,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"da154412-2c48-442e-a787-da944a665449","colab":{"base_uri":"https://localhost:8080/","height":127}},"source":["print(\"out.data:\", out.data)\n","print(\"out.grad\", out.grad)\n","print(\"out.grad_fn\", out.grad_fn)"],"execution_count":64,"outputs":[{"output_type":"stream","text":["out.data: tensor(36.)\n","out.grad None\n","out.grad_fn <SumBackward0 object at 0x7fe3026aef28>\n"],"name":"stdout"},{"output_type":"stream","text":["/usr/local/lib/python3.6/dist-packages/ipykernel_launcher.py:2: UserWarning: The .grad attribute of a Tensor that is not a leaf Tensor is being accessed. Its .grad attribute won't be populated during autograd.backward(). If you indeed want the gradient for a non-leaf Tensor, use .retain_grad() on the non-leaf Tensor. If you access the non-leaf Tensor by mistake, make sure you access the leaf Tensor instead. See github.com/pytorch/pytorch/pull/30531 for more informations.\n","  \n"],"name":"stderr"}]},{"cell_type":"markdown","metadata":{"id":"qZXgwviHfovj"},"source":["### 자동 미분 흐름 다시 보기(2)\n","- `grad`값을 넣어서 `backward`\n","\n","- 아래의 코드에서 `.grad`값이 None은 gradient값이 필요하지 않기 때문"]},{"cell_type":"code","metadata":{"id":"bB6DCYXRfcI_","executionInfo":{"status":"ok","timestamp":1603774974780,"user_tz":-540,"elapsed":12955,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"91687aa9-f660-4217-8df6-e0ac6fd3619a","colab":{"base_uri":"https://localhost:8080/","height":35}},"source":["x = torch.ones(3, requires_grad=True)\n","y = (x**2)\n","z = y**2 + x\n","out = z.sum()\n","print(out)"],"execution_count":65,"outputs":[{"output_type":"stream","text":["tensor(6., grad_fn=<SumBackward0>)\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"AVo-glm8fvFv","executionInfo":{"status":"ok","timestamp":1603774974780,"user_tz":-540,"elapsed":12944,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}}},"source":["grad = torch.Tensor([0.1, 1,  100])\n","z.backward(grad)"],"execution_count":66,"outputs":[]},{"cell_type":"code","metadata":{"id":"tdBklrepf2qq","executionInfo":{"status":"ok","timestamp":1603774974781,"user_tz":-540,"elapsed":12937,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"4e10a80c-9279-4f7c-98c9-af7ebba6aee7","colab":{"base_uri":"https://localhost:8080/","height":71}},"source":["print(\"x.data:\", x.data)\n","print(\"x.grad\", x.grad)\n","print(\"x.grad_fn\", x.grad_fn)"],"execution_count":67,"outputs":[{"output_type":"stream","text":["x.data: tensor([1., 1., 1.])\n","x.grad tensor([  0.5000,   5.0000, 500.0000])\n","x.grad_fn None\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"HQvUGlfRf7jU","executionInfo":{"status":"ok","timestamp":1603774974781,"user_tz":-540,"elapsed":12925,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"27639cf7-592b-400a-f597-0288e0f151c6","colab":{"base_uri":"https://localhost:8080/","height":127}},"source":["print(\"y.data:\", y.data)\n","print(\"y.grad\", y.grad)\n","print(\"y.grad_fn\", y.grad_fn)"],"execution_count":68,"outputs":[{"output_type":"stream","text":["y.data: tensor([1., 1., 1.])\n","y.grad None\n","y.grad_fn <PowBackward0 object at 0x7fe3026ac0f0>\n"],"name":"stdout"},{"output_type":"stream","text":["/usr/local/lib/python3.6/dist-packages/ipykernel_launcher.py:2: UserWarning: The .grad attribute of a Tensor that is not a leaf Tensor is being accessed. Its .grad attribute won't be populated during autograd.backward(). If you indeed want the gradient for a non-leaf Tensor, use .retain_grad() on the non-leaf Tensor. If you access the non-leaf Tensor by mistake, make sure you access the leaf Tensor instead. See github.com/pytorch/pytorch/pull/30531 for more informations.\n","  \n"],"name":"stderr"}]},{"cell_type":"code","metadata":{"id":"h7TFHdMfgxvW","executionInfo":{"status":"ok","timestamp":1603774974782,"user_tz":-540,"elapsed":12916,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"5aa6193d-8760-4f5d-b363-0a7b89ad2736","colab":{"base_uri":"https://localhost:8080/","height":127}},"source":["print(\"z.data:\", z.data)\n","print(\"z.grad\", z.grad)\n","print(\"z.grad_fn\", z.grad_fn)"],"execution_count":69,"outputs":[{"output_type":"stream","text":["z.data: tensor([2., 2., 2.])\n","z.grad None\n","z.grad_fn <AddBackward0 object at 0x7fe3026aa128>\n"],"name":"stdout"},{"output_type":"stream","text":["/usr/local/lib/python3.6/dist-packages/ipykernel_launcher.py:2: UserWarning: The .grad attribute of a Tensor that is not a leaf Tensor is being accessed. Its .grad attribute won't be populated during autograd.backward(). If you indeed want the gradient for a non-leaf Tensor, use .retain_grad() on the non-leaf Tensor. If you access the non-leaf Tensor by mistake, make sure you access the leaf Tensor instead. See github.com/pytorch/pytorch/pull/30531 for more informations.\n","  \n"],"name":"stderr"}]},{"cell_type":"markdown","metadata":{"id":"DKv-osmNmWiA"},"source":["## nn & nn.functional\n","\n","- 두 패키지가 같은 기능이지만 방식이 조금 다름\n","\n","- 위의 `autograd` 관련 작업들을 두 패키지를 통해 진행할 수 있음\n","\n","- 텐서를 직접 다룰 때 `requires_grad`와 같은 방식으로 진행할 수 있음\n","\n","- 결론적으로, `torch.nn`은 attribute를 활용해 state를 저장하고 활용하고,  \n","  `torch.nn.functional`로 구현한 함수의 경우에는 인스턴스화 시킬 필요 없이 사용이 가능\n"," \n"]},{"cell_type":"markdown","metadata":{"id":"jk8fkKq3nWP1"},"source":["### nn 패키지\n","\n","- 주로 가중치(weights), 편향(bias)값들이 내부에서 자동으로 생성되는 레이어들을 사용할 때  \n","  - 따라서, `weight`값들을 직접 선언 안함\n","\n","- 예시\n","  - Containers\n","\n","  - Convolution Layers\n","\n","  - Pooling layers\n","\n","  - Padding Layers\n","\n","  - Non-linear Activations (weighted sum, nonlinearity)\n","\n","  - Non-linear Activations (other)\n","\n","  - Normalization Layers\n","\n","  - Recurrent Layers\n","\n","  - Transformer Layers\n","\n","  - Linear Layers\n","\n","  - Dropout Layers\n","\n","  - Sparse Layers\n","\n","  - Distance Functions\n","\n","  - Loss Functions\n","\n","  - ..\n","- https://pytorch.org/docs/stable/nn.html\n","\n"]},{"cell_type":"code","metadata":{"id":"8tEtWHAsmZMy","executionInfo":{"status":"ok","timestamp":1603774974782,"user_tz":-540,"elapsed":12905,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}}},"source":["import torch\n","import torch.nn as nn"],"execution_count":70,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"NcjCbeEQqPSI"},"source":["- Convolution Layer 예시 (1)\n"]},{"cell_type":"code","metadata":{"id":"NQ7Y0tCOpkhM","executionInfo":{"status":"ok","timestamp":1603774974782,"user_tz":-540,"elapsed":12895,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"cfe89202-4c0f-4ccc-9547-01ae6489d5d9","colab":{"base_uri":"https://localhost:8080/","height":1000}},"source":["m = nn.Conv2d(16, 33, 3, stride=2)\n","\n","m = nn.Conv2d(16, 33, (3,5), stride=(2,1), padding=(4,2))\n","\n","m = nn.Conv2d(16, 33, (3,5), stride=(2,1), padding=(4,2), dilation=(3,1))\n","\n","input = torch.randn(20, 16, 50, 100)\n","print(input)\n","output = m(input)\n","print(output)"],"execution_count":71,"outputs":[{"output_type":"stream","text":["tensor([[[[-6.0094e-01, -4.8255e-01, -4.1835e-01,  ...,  1.9092e+00,\n","           -1.2162e+00, -2.3920e-01],\n","          [-7.9582e-01,  2.1146e+00,  7.6478e-01,  ..., -1.3769e-01,\n","           -2.2273e+00,  6.7539e-01],\n","          [-9.2539e-01, -1.2160e-01, -7.0406e-01,  ...,  3.3932e-01,\n","           -2.5619e-02,  2.2089e+00],\n","          ...,\n","          [-4.5086e-02, -1.8990e-01,  3.6469e-02,  ...,  1.1425e+00,\n","            4.1691e-01, -1.1754e+00],\n","          [ 3.1347e-01,  1.0341e-01, -2.2591e+00,  ...,  7.9233e-01,\n","           -9.5638e-01, -1.5257e-01],\n","          [ 1.4644e+00, -4.9060e-01, -1.5667e+00,  ...,  1.5010e-01,\n","           -7.1699e-01,  2.3457e-01]],\n","\n","         [[-2.0742e+00, -6.8824e-01, -5.2811e-01,  ...,  4.4338e-01,\n","           -6.5774e-03, -4.6773e-01],\n","          [ 7.2401e-01,  8.2890e-01, -3.8085e-01,  ...,  5.7191e-02,\n","           -1.1695e+00,  1.2844e+00],\n","          [ 8.2546e-01,  5.5629e-01,  3.9541e-01,  ..., -8.3388e-01,\n","           -1.7420e+00, -1.2504e-01],\n","          ...,\n","          [-8.0141e-01,  5.1495e-01,  7.8787e-01,  ..., -6.9480e-01,\n","           -9.1102e-01,  6.6032e-01],\n","          [ 4.3336e-01, -1.0111e+00, -9.5254e-01,  ...,  1.7656e+00,\n","            1.6249e-01,  1.4063e+00],\n","          [ 4.2105e-01, -9.1592e-02,  1.2782e+00,  ..., -1.7680e+00,\n","            3.1261e-01,  1.4517e-01]],\n","\n","         [[ 1.9257e+00, -1.4311e-01,  8.9314e-01,  ..., -5.5201e-01,\n","           -7.1690e-02, -1.4922e+00],\n","          [-1.6214e-01,  2.1733e-01, -6.7095e-01,  ..., -1.0250e+00,\n","            6.9115e-01, -8.3705e-01],\n","          [ 8.2188e-01,  4.3611e-01, -6.4073e-01,  ..., -3.6485e-01,\n","           -5.3564e-01,  7.2026e-01],\n","          ...,\n","          [-7.9608e-01, -5.6123e-01,  1.7406e-01,  ..., -2.5525e-01,\n","            1.8076e-01, -1.4250e+00],\n","          [ 1.8953e+00, -2.3443e-01, -1.2144e+00,  ...,  8.9309e-01,\n","            1.2557e+00,  1.7451e+00],\n","          [-1.4723e+00, -1.9083e-01,  2.5605e-01,  ..., -3.9447e-01,\n","            5.4741e-01,  1.1162e+00]],\n","\n","         ...,\n","\n","         [[-4.8895e-01, -5.4808e-02,  8.1149e-01,  ...,  1.4074e+00,\n","           -6.4142e-01, -1.5856e+00],\n","          [-4.6423e-01,  1.2638e+00,  7.2465e-01,  ..., -7.6365e-01,\n","           -1.4207e-01, -5.5001e-02],\n","          [-1.1035e+00,  7.6266e-02,  4.1160e-01,  ..., -1.1851e+00,\n","            2.2816e+00,  1.3424e-01],\n","          ...,\n","          [-7.4701e-01,  1.1009e+00, -4.7422e-01,  ..., -5.6937e-01,\n","            1.2545e+00,  1.2199e+00],\n","          [-1.0425e+00, -1.3577e+00,  2.0554e+00,  ...,  6.5666e-04,\n","           -7.6344e-01,  1.9349e+00],\n","          [-1.1574e+00, -2.0759e+00, -7.2674e-01,  ..., -1.0334e+00,\n","           -6.4345e-01, -1.9566e-01]],\n","\n","         [[ 6.2259e-01,  9.0644e-01, -6.5484e-01,  ...,  5.3806e-01,\n","            1.2560e+00, -2.4068e-01],\n","          [-5.0835e-02,  5.8567e-01, -1.5722e+00,  ..., -1.0352e+00,\n","            7.1300e-01,  8.6106e-01],\n","          [ 6.5063e-01, -1.9843e+00, -1.0787e+00,  ...,  1.7938e+00,\n","           -1.6184e+00, -1.0727e+00],\n","          ...,\n","          [ 2.4035e+00,  9.7664e-01, -1.4409e+00,  ..., -4.6432e-02,\n","            4.6106e-02,  1.3779e-01],\n","          [-5.6849e-01,  1.1950e-01,  1.5174e+00,  ..., -8.2022e-02,\n","            8.7023e-01, -1.6032e+00],\n","          [-1.0506e+00, -1.2898e+00, -1.4674e-01,  ..., -6.8646e-01,\n","           -9.0375e-01,  1.8532e+00]],\n","\n","         [[-6.7965e-01, -1.2089e+00,  5.8615e-01,  ...,  1.0137e+00,\n","           -8.8792e-01,  6.9873e-01],\n","          [-1.0115e+00, -1.0164e-01,  1.8410e-01,  ...,  1.6748e+00,\n","            2.5131e+00,  8.6229e-01],\n","          [-8.3592e-01,  5.7193e-01,  3.2821e-01,  ...,  1.3802e+00,\n","            7.8020e-01, -4.0692e-01],\n","          ...,\n","          [ 5.8844e-01, -6.7547e-01, -4.4431e-01,  ..., -1.0608e+00,\n","            6.1232e-01, -7.2604e-01],\n","          [-1.8822e+00, -4.0326e-01, -2.0741e+00,  ...,  5.0513e-01,\n","           -4.8921e-01,  4.7796e-01],\n","          [-1.7264e-01, -1.0158e+00, -2.9971e-01,  ..., -1.5563e-01,\n","            5.0244e-01,  1.0327e-01]]],\n","\n","\n","        [[[-8.0564e-01, -1.6672e-02,  8.7628e-01,  ..., -7.3946e-01,\n","            1.0736e-01, -9.1970e-01],\n","          [-1.4888e+00, -8.8055e-01,  6.0623e-01,  ...,  6.2305e-01,\n","           -1.6153e-01,  1.1550e+00],\n","          [-9.4895e-01, -3.9067e-01,  9.5919e-01,  ...,  3.7932e+00,\n","           -1.6344e-03, -3.4412e-01],\n","          ...,\n","          [ 6.3421e-01, -2.1982e-01,  8.3144e-01,  ..., -1.2179e+00,\n","           -1.6226e+00, -2.8074e-01],\n","          [-1.3515e+00, -9.3020e-02,  1.1697e+00,  ..., -3.1620e-03,\n","           -1.7561e-01, -1.2880e-01],\n","          [-1.6210e-02,  1.0127e+00, -5.8903e-01,  ...,  9.3923e-01,\n","            1.2974e+00,  2.4120e-02]],\n","\n","         [[ 3.6946e-01,  7.4567e-02,  1.7857e+00,  ...,  9.7492e-01,\n","           -3.9593e-01,  1.1371e+00],\n","          [-1.1908e-01,  1.7017e+00, -4.6133e-01,  ...,  7.3688e-01,\n","            2.0104e+00, -4.8814e-01],\n","          [-2.1243e+00,  1.1001e+00, -8.0814e-01,  ..., -1.4147e+00,\n","           -4.7496e-01,  1.6441e-01],\n","          ...,\n","          [ 1.3884e+00, -8.8684e-01, -1.2714e+00,  ...,  9.5460e-01,\n","           -5.4696e-01, -1.7526e+00],\n","          [-5.7977e-01, -7.4647e-02,  5.0274e-02,  ...,  9.0983e-01,\n","           -1.0337e+00, -2.4747e-01],\n","          [ 2.3548e-01,  1.4483e-01, -7.2029e-02,  ...,  9.3221e-01,\n","            1.2705e+00, -4.7864e-01]],\n","\n","         [[ 3.6114e-03,  4.3163e-03, -4.9205e-01,  ...,  4.1699e-01,\n","           -1.2105e+00, -2.1636e+00],\n","          [-1.1965e+00,  1.0832e+00, -2.4102e+00,  ..., -2.4691e-01,\n","           -1.1306e+00,  5.9009e-01],\n","          [ 4.4603e-02,  8.6049e-01,  3.6871e-01,  ..., -1.1464e+00,\n","            4.3532e-01,  8.2344e-01],\n","          ...,\n","          [-6.1371e-01,  1.0933e+00,  1.4948e-01,  ..., -6.1401e-02,\n","           -2.0363e-01,  2.8485e-01],\n","          [-1.9208e+00, -1.6822e-02,  5.4068e-01,  ...,  8.4979e-01,\n","            4.1118e-01,  5.6469e-01],\n","          [ 1.1306e+00,  4.6866e-01, -4.5094e-01,  ..., -2.6048e+00,\n","            1.4321e+00,  6.4578e-01]],\n","\n","         ...,\n","\n","         [[-1.1384e+00, -1.0593e+00, -3.3556e-01,  ..., -1.6933e+00,\n","            1.0675e+00,  1.0658e+00],\n","          [-4.4619e-01,  7.6453e-01, -4.2079e-01,  ..., -1.5702e+00,\n","           -3.4644e-01,  5.2087e-01],\n","          [ 6.1286e-02,  1.3438e+00, -6.1764e-02,  ...,  1.4014e-01,\n","            2.3299e-01, -6.4862e-02],\n","          ...,\n","          [-8.3885e-02, -1.4233e+00,  3.4934e-02,  ...,  6.6791e-01,\n","            2.3216e-01, -4.5428e-01],\n","          [ 1.4344e+00,  3.2523e+00, -5.9693e-01,  ...,  9.9595e-01,\n","            1.0534e+00,  2.3081e+00],\n","          [ 3.3177e-02,  3.6801e-01, -3.5712e-01,  ..., -1.5460e+00,\n","            6.9327e-01, -1.7739e-01]],\n","\n","         [[-8.1202e-01,  3.2072e-01, -6.1230e-01,  ...,  3.8629e-01,\n","            8.8271e-01, -1.6192e-01],\n","          [-7.9569e-02, -6.2564e-01,  2.3719e-02,  ..., -4.4660e-01,\n","            8.6175e-02,  2.9786e+00],\n","          [-4.3923e-02,  3.1810e-02, -8.8636e-02,  ...,  3.3432e-01,\n","           -3.5253e-01, -7.2210e-01],\n","          ...,\n","          [ 8.8194e-01,  2.3096e-01,  1.5104e+00,  ...,  1.1540e+00,\n","           -3.8660e-01, -1.5595e-01],\n","          [ 3.8342e-01, -6.5579e-01,  1.5493e+00,  ...,  9.1959e-01,\n","            4.3470e-01,  1.7622e-01],\n","          [-1.9166e+00, -4.8807e-01,  5.2512e-01,  ..., -2.5024e+00,\n","           -2.3184e-01,  1.6802e+00]],\n","\n","         [[ 1.7092e+00,  2.1323e-01, -6.5160e-01,  ..., -8.2799e-01,\n","            6.5973e-01, -4.4876e-02],\n","          [-9.1971e-01,  1.9296e-01, -1.9889e-02,  ...,  7.0664e-01,\n","           -9.8758e-01, -1.0826e+00],\n","          [-2.3043e-01,  1.5210e+00, -1.2595e+00,  ...,  6.5490e-01,\n","           -3.2278e-01,  4.2780e-01],\n","          ...,\n","          [-1.1238e+00,  1.6217e+00, -5.3099e-01,  ..., -6.1521e-02,\n","            1.5537e+00,  4.5394e-01],\n","          [-2.1234e+00, -3.4963e+00,  2.0497e+00,  ...,  3.0350e-01,\n","           -5.9928e-01, -2.7338e-01],\n","          [ 2.0895e+00,  3.4462e-01,  1.4529e-01,  ..., -1.1299e+00,\n","            1.6086e+00, -4.8941e-01]]],\n","\n","\n","        [[[ 1.3812e+00, -5.4319e-01,  7.6510e-01,  ...,  3.2581e-01,\n","            5.8746e-01, -1.0519e+00],\n","          [-1.4771e+00,  1.0076e-01, -1.0108e+00,  ...,  1.0507e+00,\n","           -2.3844e+00,  4.8736e-01],\n","          [ 1.7418e+00, -5.4232e-01,  6.4454e-03,  ..., -6.3679e-01,\n","            1.2188e+00, -2.3775e-01],\n","          ...,\n","          [ 3.7288e-01,  1.8543e-01,  1.0015e-01,  ...,  2.0747e-01,\n","            1.1011e+00,  1.4695e+00],\n","          [ 6.8430e-01,  6.2592e-01, -5.8302e-01,  ...,  2.0587e+00,\n","            5.9291e-01, -9.5987e-01],\n","          [-8.8208e-01, -4.8935e-01, -1.8296e-01,  ..., -1.5360e-01,\n","            7.7355e-01,  8.4998e-02]],\n","\n","         [[ 1.3493e+00, -1.2943e+00,  1.5580e-01,  ..., -1.3966e-01,\n","           -2.3081e-01, -1.1566e+00],\n","          [ 1.8011e+00,  8.4656e-01,  5.7585e-04,  ..., -1.1390e+00,\n","            9.0434e-01,  5.9650e-01],\n","          [-1.5272e+00,  7.5951e-01, -9.0685e-01,  ...,  6.7630e-01,\n","           -7.9646e-01,  7.3328e-01],\n","          ...,\n","          [ 1.2473e+00, -8.0914e-01, -2.9204e-01,  ..., -2.7245e+00,\n","           -1.7231e-02,  4.3287e-02],\n","          [-5.9756e-01,  1.3382e+00,  1.1790e+00,  ..., -7.6812e-01,\n","           -8.0666e-01,  4.3769e-01],\n","          [ 1.4668e+00,  1.2484e-02,  1.1961e+00,  ...,  1.3122e+00,\n","           -5.8015e-01,  8.6600e-01]],\n","\n","         [[ 1.4066e+00, -2.4900e+00,  7.9115e-01,  ..., -1.7388e+00,\n","           -7.7378e-01, -1.4078e+00],\n","          [-5.1771e-01, -2.9872e-01,  2.9212e-01,  ...,  6.9303e-01,\n","           -2.7871e-01,  2.2819e+00],\n","          [ 7.5205e-01, -1.7628e+00,  3.2624e-01,  ..., -3.7654e-01,\n","            8.4939e-01, -5.1304e-01],\n","          ...,\n","          [-4.1807e-01, -4.6036e-01, -2.5802e-01,  ..., -2.3848e+00,\n","           -1.0983e+00,  2.2351e-01],\n","          [ 8.2928e-02,  5.8166e-01,  5.6905e-01,  ..., -7.1061e-01,\n","            7.5398e-01,  7.0697e-01],\n","          [-1.0283e+00, -3.4389e-02, -2.6136e-01,  ...,  8.7752e-01,\n","           -1.0701e+00, -1.0914e+00]],\n","\n","         ...,\n","\n","         [[-5.3027e-01, -1.8543e+00,  1.3200e+00,  ..., -1.6012e+00,\n","            1.2183e+00, -6.4081e-01],\n","          [-7.4807e-01,  1.2063e+00,  1.1775e+00,  ..., -1.0036e+00,\n","            2.6226e+00, -3.0723e-01],\n","          [ 2.5402e-01,  5.6199e-01, -2.4772e+00,  ..., -1.4065e+00,\n","           -1.9717e+00,  1.4263e+00],\n","          ...,\n","          [ 2.9308e-01,  8.6301e-01,  1.5211e+00,  ..., -1.9980e-02,\n","           -1.0444e+00,  4.6241e-01],\n","          [-1.2229e+00,  8.3636e-01,  4.2582e-01,  ..., -3.3728e-01,\n","            5.6930e-01,  1.3448e+00],\n","          [-1.2510e+00, -8.2911e-01, -4.6424e-01,  ..., -8.8185e-01,\n","           -7.3423e-01,  8.0674e-01]],\n","\n","         [[-1.7950e-01, -2.7431e-01,  2.4749e-01,  ...,  1.9011e+00,\n","            5.6762e-01, -4.6304e-01],\n","          [ 1.2745e+00, -2.4543e-01,  1.2610e+00,  ..., -3.1530e-01,\n","           -1.4185e+00,  1.4302e+00],\n","          [ 4.8791e-01,  8.7136e-01,  1.4406e+00,  ...,  2.4180e+00,\n","            1.2605e-01, -1.2544e+00],\n","          ...,\n","          [-2.3433e+00, -2.1109e-01,  5.9781e-01,  ...,  6.4661e-01,\n","           -4.8356e-01,  9.2360e-01],\n","          [-4.6041e-02, -2.6273e+00,  8.4525e-01,  ...,  1.3498e+00,\n","            3.4194e-01, -3.1443e-01],\n","          [ 1.8726e-01, -2.3772e+00, -1.4565e+00,  ...,  1.8547e-01,\n","            1.2594e+00, -1.0852e+00]],\n","\n","         [[ 1.5152e+00,  2.2620e+00, -3.1935e-02,  ..., -8.4521e-01,\n","            6.3687e-01, -5.8706e-02],\n","          [ 6.7596e-01, -4.5565e-01,  2.4186e-01,  ...,  1.2383e+00,\n","            2.3245e+00, -1.1370e+00],\n","          [-4.3986e-01,  1.4430e+00,  8.6199e-01,  ..., -6.0832e-01,\n","            2.1843e-02, -5.8022e-01],\n","          ...,\n","          [-1.5787e+00, -1.4665e+00, -1.3654e+00,  ..., -1.5842e+00,\n","            8.1285e-01, -8.3543e-02],\n","          [ 1.4087e+00,  1.0049e+00, -6.8223e-01,  ...,  1.2719e+00,\n","           -1.7191e-01,  1.2687e+00],\n","          [-8.5936e-01,  2.2704e-01, -1.2895e-01,  ...,  2.2007e-01,\n","            6.1953e-01, -3.6421e-01]]],\n","\n","\n","        ...,\n","\n","\n","        [[[ 2.5431e+00, -2.7423e+00, -1.3208e+00,  ...,  1.0636e+00,\n","           -6.8345e-01,  2.9286e+00],\n","          [ 8.5282e-01, -5.4166e-01, -2.8678e-01,  ...,  1.1175e-01,\n","           -1.3827e+00,  1.0117e+00],\n","          [ 8.6425e-01,  2.9331e-01, -1.4691e+00,  ..., -1.1010e+00,\n","           -6.6221e-01,  1.8596e+00],\n","          ...,\n","          [-6.1795e-01, -1.5601e+00,  1.0586e+00,  ..., -1.1666e+00,\n","            8.3377e-01,  3.4364e-01],\n","          [ 5.6773e-01, -9.2453e-01,  9.7784e-01,  ..., -1.2642e+00,\n","           -1.0155e+00, -1.1265e+00],\n","          [-5.9482e-01, -8.0424e-01,  9.9222e-01,  ...,  3.8000e-01,\n","           -1.8566e+00, -1.5988e-01]],\n","\n","         [[-3.4199e-01, -6.5728e-01, -7.4294e-01,  ...,  1.8583e+00,\n","            1.1070e+00, -4.9199e-01],\n","          [-2.7431e-01,  1.3619e+00, -5.9615e-01,  ...,  9.5696e-01,\n","            2.0493e+00, -1.7078e+00],\n","          [ 5.2235e-01,  7.1597e-02,  7.7294e-01,  ...,  1.4493e+00,\n","            6.2475e-01,  2.6911e-01],\n","          ...,\n","          [-9.9981e-01, -6.4422e-01,  9.2677e-01,  ..., -7.2378e-01,\n","           -8.3984e-01, -1.9079e-01],\n","          [-5.9469e-01, -1.3591e+00,  1.0748e-01,  ...,  2.5083e-01,\n","           -5.4424e-01,  5.6447e-01],\n","          [ 4.6010e-01,  6.0772e-01,  1.9201e+00,  ..., -3.3563e-01,\n","           -5.5309e-01, -1.6156e+00]],\n","\n","         [[-2.0111e-01, -4.0387e-01, -2.3925e+00,  ..., -2.7070e-01,\n","           -7.5278e-01, -1.2731e+00],\n","          [ 1.7512e+00, -2.4818e+00,  9.5961e-01,  ..., -1.2562e+00,\n","           -9.4649e-01, -1.1176e+00],\n","          [ 8.8445e-01,  4.0259e-01, -1.4682e-01,  ..., -7.1372e-01,\n","           -7.7510e-01,  2.7406e-01],\n","          ...,\n","          [ 5.8101e-01,  1.6481e-01,  7.9626e-01,  ...,  1.0133e+00,\n","           -3.0460e-01, -1.4219e+00],\n","          [ 1.5790e+00, -9.5159e-01, -5.1001e-01,  ...,  8.1649e-01,\n","            2.6392e-01, -9.8381e-01],\n","          [ 7.9897e-01, -6.9305e-01, -9.5300e-01,  ..., -6.4436e-01,\n","           -1.5563e-02, -9.2164e-01]],\n","\n","         ...,\n","\n","         [[-3.8511e-01, -1.4576e+00, -3.8217e-01,  ..., -4.5718e-01,\n","           -1.0908e+00,  1.4527e-02],\n","          [ 1.5560e+00,  7.2610e-01,  5.4795e-01,  ..., -1.6622e+00,\n","            2.9654e-01, -1.3734e-01],\n","          [-6.1632e-01, -4.6739e-02, -3.7045e-01,  ...,  1.4493e-01,\n","            2.2419e-01, -5.0334e-01],\n","          ...,\n","          [ 1.6198e-01,  1.6469e+00,  5.3128e-01,  ..., -1.0391e+00,\n","            4.8352e-01,  7.1719e-01],\n","          [-8.4762e-04,  1.0147e+00, -2.8503e-01,  ..., -1.2599e+00,\n","            5.3133e-01,  8.8917e-02],\n","          [-1.5664e+00, -5.7806e-01,  6.2519e-01,  ..., -1.1469e+00,\n","           -1.7952e+00, -8.9032e-01]],\n","\n","         [[ 1.0677e+00, -8.3325e-01, -5.8789e-01,  ..., -7.8022e-02,\n","           -2.8904e-01, -7.0448e-02],\n","          [-8.9445e-01,  1.1703e+00, -7.0187e-01,  ...,  3.8740e-01,\n","           -1.3368e-01, -5.6607e-01],\n","          [-3.1775e-01,  2.1619e-01,  2.0009e-01,  ..., -8.5857e-01,\n","            1.3663e+00, -9.4093e-01],\n","          ...,\n","          [ 6.2215e-01,  1.9403e-01,  7.5741e-01,  ..., -1.5868e+00,\n","           -2.9009e-01, -9.8417e-02],\n","          [-2.7033e+00,  8.8873e-01, -7.0700e-01,  ..., -8.2203e-01,\n","            1.0115e-02,  1.8377e-01],\n","          [ 1.1214e+00,  5.5086e-01, -6.3037e-01,  ...,  1.1243e+00,\n","            1.7914e+00, -1.6689e-01]],\n","\n","         [[ 3.1960e-01, -6.0800e-02, -9.6552e-02,  ..., -8.7428e-01,\n","            1.3354e+00, -7.8702e-02],\n","          [-1.6669e+00, -5.8480e-01, -8.7204e-02,  ...,  1.7818e+00,\n","            2.2773e-01, -5.3550e-01],\n","          [ 2.5239e-01, -1.6247e+00, -2.8823e-01,  ...,  1.0249e-01,\n","            4.2818e-01,  7.8264e-01],\n","          ...,\n","          [ 1.6599e-01,  5.0194e-01,  2.3714e+00,  ...,  6.3510e-01,\n","           -5.8587e-01, -2.6714e+00],\n","          [ 7.3801e-01, -1.9267e+00, -2.4130e-01,  ...,  4.3602e-01,\n","            8.1979e-01,  4.1075e-01],\n","          [ 5.9755e-01, -4.2036e-01, -8.1435e-01,  ...,  8.4104e-01,\n","            8.3282e-01,  9.4656e-01]]],\n","\n","\n","        [[[ 1.8971e+00,  2.4517e-01, -3.1597e-01,  ...,  7.3769e-01,\n","            4.4150e-01,  1.2180e-01],\n","          [-1.4194e+00, -5.4705e-01, -2.9279e+00,  ...,  2.2415e-01,\n","            1.0422e+00,  2.1937e-01],\n","          [-7.0113e-01, -1.3414e+00,  1.3282e+00,  ..., -1.0995e-01,\n","           -4.7738e-01, -2.8057e-01],\n","          ...,\n","          [-1.4410e+00, -1.4516e+00, -7.3994e-01,  ..., -9.1005e-01,\n","           -1.3481e+00,  8.2129e-01],\n","          [ 7.0431e-02, -1.6505e+00, -1.4099e+00,  ..., -7.8329e-01,\n","            5.8807e-01, -8.6643e-02],\n","          [ 9.1336e-01, -4.6641e-01, -5.1394e-01,  ..., -4.3597e-01,\n","           -1.9648e-02,  2.1455e+00]],\n","\n","         [[ 2.0421e-01,  2.0385e+00,  8.3025e-02,  ...,  3.5522e-01,\n","            7.2181e-01,  8.2159e-01],\n","          [ 1.5804e-01, -1.2032e+00, -8.1892e-01,  ...,  2.0342e-01,\n","           -6.4414e-02, -3.4950e-01],\n","          [ 1.5644e+00,  1.5427e+00,  9.6215e-01,  ..., -1.3915e+00,\n","           -1.0789e-01, -7.4537e-01],\n","          ...,\n","          [-1.7435e+00, -3.2858e-01, -1.6669e+00,  ...,  3.6165e-01,\n","           -6.8231e-01, -4.1124e-02],\n","          [-8.8352e-01, -1.0944e+00,  2.5844e-01,  ...,  3.4923e-02,\n","            1.8378e+00,  1.1574e+00],\n","          [-7.9016e-02, -1.9091e+00, -1.1462e+00,  ..., -4.5364e-01,\n","            3.2344e-01,  1.0210e+00]],\n","\n","         [[ 1.5111e-01,  1.2134e+00,  2.0277e-01,  ..., -9.3865e-01,\n","           -4.6387e-01, -6.7103e-02],\n","          [ 1.0568e+00, -1.1355e-01,  1.5443e+00,  ...,  9.0496e-02,\n","           -2.0134e+00, -3.5608e-02],\n","          [-8.2415e-01, -9.9716e-02, -3.7299e-01,  ..., -5.7781e-01,\n","           -1.7144e+00,  3.9700e-01],\n","          ...,\n","          [-1.9005e-01,  2.7168e-01, -8.2661e-01,  ...,  4.0004e-01,\n","            1.1443e+00, -5.1723e-01],\n","          [-3.6702e-01,  5.1400e-01, -1.0003e+00,  ...,  9.4719e-02,\n","            1.4852e+00,  9.5539e-01],\n","          [-7.3081e-01, -9.9452e-01, -6.9384e-01,  ...,  6.5195e-01,\n","           -5.8569e-04, -3.4600e-01]],\n","\n","         ...,\n","\n","         [[-2.5847e+00,  5.8821e-01, -6.4125e-01,  ..., -9.8498e-01,\n","            1.3807e-01,  4.0468e-03],\n","          [-5.5849e-01, -1.1834e+00, -1.0948e-01,  ...,  1.3289e+00,\n","            1.6457e+00, -1.5940e-02],\n","          [-2.3727e+00, -1.6764e+00, -2.7377e-01,  ..., -8.5224e-01,\n","            5.0899e-01, -2.9943e-01],\n","          ...,\n","          [-1.2095e+00, -2.1293e+00,  9.2017e-01,  ...,  1.1233e-01,\n","            3.8848e-01,  2.1266e+00],\n","          [ 2.8968e-01, -1.0079e+00,  1.7187e-01,  ...,  4.1687e-01,\n","           -5.3404e-01,  1.2780e+00],\n","          [-5.2351e-01,  2.6876e-02,  3.5550e-01,  ..., -1.0052e+00,\n","           -5.6106e-01,  6.8476e-01]],\n","\n","         [[-1.1587e-01,  1.0484e+00, -1.7149e+00,  ..., -3.4858e-01,\n","            7.4739e-01,  1.0992e+00],\n","          [-3.5881e-01, -1.2104e+00, -3.2776e-01,  ...,  1.5195e-01,\n","           -1.5544e-01, -5.2883e-01],\n","          [ 3.0723e-01,  1.0393e+00, -3.7341e-02,  ..., -8.4778e-02,\n","            1.2476e+00,  5.8060e-01],\n","          ...,\n","          [ 1.2601e-01,  3.8229e-01,  6.0686e-01,  ...,  2.4040e+00,\n","           -1.4068e+00,  8.9463e-01],\n","          [-1.6353e-01,  1.5723e+00, -1.6393e+00,  ..., -1.9266e+00,\n","           -2.9400e-01,  7.7316e-01],\n","          [-2.1567e-01,  3.3546e-01, -1.4337e+00,  ...,  9.6945e-01,\n","           -2.3303e+00, -1.4795e+00]],\n","\n","         [[-5.0445e-01,  1.5015e+00,  3.9425e-01,  ..., -4.5076e-01,\n","           -1.0122e+00, -1.6805e+00],\n","          [-6.1928e-01, -5.5148e-01, -1.0317e+00,  ...,  3.0557e-01,\n","           -1.2333e+00,  5.5578e-01],\n","          [-2.8768e-01,  2.6279e+00, -7.0093e-02,  ...,  9.9913e-01,\n","            3.6443e-01,  4.7062e-01],\n","          ...,\n","          [-2.9347e-01,  1.2352e-01,  8.8321e-01,  ...,  6.3843e-01,\n","           -1.2959e-01,  1.0711e+00],\n","          [ 3.5000e-01, -1.2096e+00, -7.3239e-01,  ...,  8.6967e-01,\n","            4.6679e-01, -4.9002e-01],\n","          [ 2.3252e-01,  1.7008e+00, -2.8956e-01,  ..., -1.9538e+00,\n","            3.5170e-01, -1.9099e+00]]],\n","\n","\n","        [[[ 1.1455e+00,  3.3914e-01, -9.5382e-01,  ...,  4.9154e-01,\n","            6.1832e-01,  2.7855e-01],\n","          [ 7.4711e-02,  6.4476e-01,  5.6997e-01,  ...,  6.5748e-03,\n","            3.4603e-01, -1.3330e+00],\n","          [-1.5181e-01,  4.6796e-02, -1.4931e+00,  ...,  1.1017e+00,\n","            6.5160e-01, -1.0035e+00],\n","          ...,\n","          [ 1.9327e+00, -1.6078e+00, -9.7175e-01,  ..., -1.3307e+00,\n","           -9.6408e-01, -7.7886e-01],\n","          [ 1.4970e+00, -2.0806e+00,  2.5032e-01,  ...,  1.2257e+00,\n","           -2.9001e-01, -1.0883e+00],\n","          [ 2.6016e-01,  4.0256e-01,  1.4272e+00,  ..., -1.1397e+00,\n","           -1.7428e-02, -1.9294e+00]],\n","\n","         [[ 4.8187e-01, -1.4275e+00,  2.2102e-01,  ...,  3.7503e-01,\n","            1.4316e+00,  1.4937e+00],\n","          [ 1.7573e+00,  2.4437e-01,  1.9101e-01,  ..., -2.7517e-02,\n","            1.7855e+00,  1.8939e-01],\n","          [-1.8708e-01, -1.2068e+00, -7.5589e-01,  ..., -9.9047e-01,\n","           -7.5596e-01, -1.4476e+00],\n","          ...,\n","          [ 1.3952e+00, -5.4882e-01,  9.3090e-02,  ..., -4.7182e-01,\n","            2.4117e-01, -9.2507e-02],\n","          [-6.5442e-01,  3.8725e-01, -9.3724e-01,  ..., -2.1519e+00,\n","           -2.2967e+00,  2.0058e-02],\n","          [-2.8143e-01,  1.0387e+00, -4.3321e-02,  ..., -5.8215e-01,\n","            1.2636e+00,  1.2200e+00]],\n","\n","         [[ 3.3823e-01, -1.0971e+00,  2.1522e+00,  ...,  9.0924e-01,\n","           -3.4087e-01,  1.2369e-02],\n","          [-9.9823e-01,  2.2326e-02, -3.7033e-01,  ...,  4.0179e-01,\n","            1.9104e-01, -1.4143e+00],\n","          [-4.9259e-01,  5.5747e-01, -3.4243e-02,  ..., -1.2067e+00,\n","            8.1844e-01,  2.1572e+00],\n","          ...,\n","          [ 1.8834e+00,  7.1092e-01, -1.4676e+00,  ..., -1.4225e+00,\n","           -1.0473e+00,  7.6919e-01],\n","          [ 1.4245e-01,  7.6941e-01, -1.0845e+00,  ..., -6.8917e-01,\n","            4.9973e-01, -8.7510e-01],\n","          [ 5.2556e-01, -1.8277e+00, -1.0721e+00,  ...,  1.2115e+00,\n","            1.2240e+00, -1.7802e-01]],\n","\n","         ...,\n","\n","         [[-1.7941e+00,  2.3559e+00,  1.1424e+00,  ...,  1.2831e+00,\n","            6.7078e-01,  2.9005e+00],\n","          [ 1.0666e+00,  1.2590e+00, -3.1161e-01,  ..., -4.5921e-01,\n","           -4.4588e-01, -1.9901e+00],\n","          [-7.9512e-01, -2.7861e-01,  2.4097e-01,  ...,  2.4365e+00,\n","           -1.8491e+00,  2.0231e+00],\n","          ...,\n","          [-1.4852e-01,  2.1383e+00,  1.3284e+00,  ...,  1.3980e-01,\n","            2.1405e+00, -4.4351e-01],\n","          [ 7.7590e-01,  3.7733e-01, -8.1035e-01,  ...,  2.9473e-01,\n","            7.4230e-01, -5.9341e-01],\n","          [ 1.8121e+00, -2.5797e-01,  5.5406e-02,  ...,  1.5016e+00,\n","           -3.5470e-01,  9.5253e-02]],\n","\n","         [[-8.1068e-02, -5.2524e-01,  3.7757e-01,  ..., -5.0946e-01,\n","           -4.7245e-01,  5.4754e-01],\n","          [ 7.7730e-01,  3.3584e-01, -8.5394e-01,  ..., -1.0529e+00,\n","            5.6809e-01,  6.8867e-01],\n","          [-5.9803e-01,  2.0608e-01,  1.4569e+00,  ...,  2.7987e-01,\n","           -1.0521e-01,  1.0734e+00],\n","          ...,\n","          [-5.4700e-01, -3.4920e-01, -7.4608e-01,  ..., -6.3041e-03,\n","           -3.2549e-01,  1.4384e+00],\n","          [-4.0864e-01,  7.6303e-01, -5.5959e-01,  ...,  7.9835e-01,\n","            2.1125e-02, -8.8867e-02],\n","          [-2.6820e-01, -9.0313e-01,  6.7055e-01,  ...,  2.7008e-02,\n","            8.3725e-01, -4.7899e-01]],\n","\n","         [[-3.6588e-01,  5.0829e-02, -2.0807e-01,  ...,  2.6774e-02,\n","            1.6471e-02,  5.2013e-01],\n","          [ 4.8935e-01, -1.0253e+00, -1.4299e+00,  ..., -6.8989e-01,\n","           -2.2865e-01, -5.8745e-01],\n","          [-3.4708e-01,  3.3615e-02, -1.0138e+00,  ..., -1.2783e+00,\n","            1.8101e+00, -4.7956e-01],\n","          ...,\n","          [ 4.4214e-01,  2.3021e+00,  2.3980e+00,  ..., -1.0158e-01,\n","            3.3565e-01, -7.2146e-01],\n","          [-7.8071e-01,  1.2096e+00,  1.7390e-01,  ...,  5.1009e-01,\n","           -9.4131e-01,  9.7637e-03],\n","          [ 9.5533e-01, -1.0406e+00,  1.8589e-01,  ...,  6.5323e-01,\n","            8.9602e-01, -8.2792e-01]]]])\n","tensor([[[[-4.6589e-01,  3.8833e-01, -1.2807e-01,  ..., -3.1495e-01,\n","            9.2033e-02,  3.8669e-01],\n","          [-3.6198e-01,  5.5161e-01, -1.1692e-01,  ..., -6.1024e-01,\n","            1.7915e-01, -3.6199e-02],\n","          [-2.5288e-02, -7.3410e-01,  1.2495e+00,  ...,  1.0401e+00,\n","            1.9764e-03,  4.0086e-01],\n","          ...,\n","          [ 1.8663e-01, -6.0072e-01, -1.3189e+00,  ...,  4.1874e-01,\n","            1.3425e+00, -1.2888e-01],\n","          [-8.6435e-02,  1.7760e-01, -5.3890e-01,  ..., -1.3902e-01,\n","           -4.7155e-01,  4.8656e-01],\n","          [ 2.1727e-01, -4.9587e-01,  1.3904e-02,  ...,  3.3808e-01,\n","            1.3171e-01, -4.5706e-02]],\n","\n","         [[ 5.6055e-02,  2.1604e-01,  2.1191e-01,  ..., -8.0543e-02,\n","           -3.1369e-01, -2.2826e-01],\n","          [ 5.2008e-01,  1.8993e-01,  9.8014e-02,  ...,  3.2094e-01,\n","           -1.8230e-01,  4.5939e-01],\n","          [ 5.3585e-01,  6.7457e-01,  8.0232e-01,  ...,  1.0832e+00,\n","           -1.1248e-01, -4.2769e-02],\n","          ...,\n","          [-1.6634e-01, -3.8580e-01,  1.0829e-01,  ..., -3.7367e-01,\n","           -1.9945e-01,  4.0345e-01],\n","          [ 5.5747e-01,  2.8616e-01,  4.0491e-01,  ...,  6.8937e-01,\n","           -3.6084e-02,  2.3284e-01],\n","          [ 4.1221e-01,  6.1536e-01,  1.0581e+00,  ..., -5.1836e-02,\n","            6.1243e-01, -2.8836e-01]],\n","\n","         [[ 2.8935e-01, -9.9038e-02,  5.7585e-01,  ..., -7.2120e-01,\n","           -2.0448e-02, -2.2293e-01],\n","          [ 2.9669e-01,  4.6494e-01, -2.5931e-01,  ..., -1.5564e-01,\n","           -1.3444e-01,  7.3977e-01],\n","          [ 5.4796e-01,  7.2460e-01,  1.4388e+00,  ..., -2.8761e-01,\n","           -1.7482e-01,  1.0889e+00],\n","          ...,\n","          [-3.3439e-02, -6.4776e-01, -7.1431e-01,  ...,  5.0952e-01,\n","            6.8122e-01,  1.7393e-01],\n","          [ 3.1446e-01,  1.2063e-01,  7.8304e-01,  ..., -3.2312e-02,\n","            1.0380e-01,  1.5865e-01],\n","          [-5.7100e-01,  2.4491e-02, -9.2688e-02,  ...,  2.0625e-01,\n","           -3.2934e-01,  5.8663e-02]],\n","\n","         ...,\n","\n","         [[ 9.5823e-02, -1.0439e-01, -1.7398e-01,  ...,  4.1937e-02,\n","            3.4135e-01, -3.4254e-01],\n","          [ 4.9017e-01, -5.0019e-01, -8.1412e-02,  ..., -2.3434e-01,\n","            4.4639e-02, -7.2079e-01],\n","          [ 4.8462e-01, -1.5897e-01, -5.6504e-01,  ...,  2.9393e-02,\n","           -5.1748e-02, -1.1168e+00],\n","          ...,\n","          [-2.6336e-01, -8.2446e-01, -8.8109e-01,  ...,  5.1266e-01,\n","           -5.7340e-01, -3.1172e-01],\n","          [-2.0921e-01,  3.2429e-02, -4.4460e-01,  ..., -4.8060e-01,\n","           -7.5820e-02, -2.1906e-01],\n","          [ 2.0406e-01, -4.4883e-01,  3.1868e-01,  ..., -5.7782e-01,\n","           -5.0250e-02,  3.2038e-01]],\n","\n","         [[-3.1652e-01, -1.8765e-01,  2.3831e-01,  ..., -3.8019e-02,\n","            3.2384e-01,  1.6854e-01],\n","          [ 6.1253e-01, -2.2587e-01,  5.6866e-01,  ..., -1.8600e-01,\n","           -1.2077e-01, -6.2641e-01],\n","          [ 8.2126e-02,  5.8359e-01, -4.5696e-02,  ...,  2.1547e-01,\n","            7.5634e-02, -4.9489e-01],\n","          ...,\n","          [-2.2631e-02, -1.2204e+00, -2.5689e-01,  ..., -1.1815e-01,\n","            3.8999e-01, -1.1360e+00],\n","          [-1.5065e-01, -4.9446e-02,  4.9019e-01,  ...,  4.1737e-01,\n","           -1.2606e-01, -1.4461e-01],\n","          [ 3.3536e-01,  4.2607e-01,  3.4386e-01,  ..., -6.6939e-01,\n","           -2.6584e-01,  2.3854e-01]],\n","\n","         [[-1.3413e-01,  4.2764e-02, -3.9698e-02,  ...,  2.5731e-01,\n","            3.5879e-02, -1.3950e-01],\n","          [-5.2681e-01,  8.0436e-01, -3.3536e-01,  ..., -4.5642e-01,\n","            3.0624e-01,  5.0839e-01],\n","          [-2.2297e-01,  5.6136e-01, -4.6861e-02,  ...,  6.1604e-01,\n","            1.2149e+00,  8.1828e-02],\n","          ...,\n","          [-3.2088e-01, -4.9007e-01, -7.3224e-01,  ...,  3.8901e-01,\n","            1.6795e-01, -5.3732e-01],\n","          [ 2.2184e-01, -3.2586e-01,  6.6639e-02,  ...,  5.9483e-01,\n","           -4.6036e-01,  7.1879e-01],\n","          [-1.5993e-01,  1.3411e-01,  4.0531e-01,  ..., -2.5385e-01,\n","            6.2502e-01,  3.4116e-01]]],\n","\n","\n","        [[[ 2.3158e-01, -4.0349e-01,  7.3998e-01,  ...,  7.4519e-01,\n","           -9.8692e-02,  1.1646e-01],\n","          [-7.3024e-01,  2.6205e-01, -1.4867e-01,  ..., -1.7873e-02,\n","            8.7569e-02,  2.4471e-01],\n","          [ 2.5911e-01, -6.4857e-01, -4.7237e-01,  ...,  9.3213e-01,\n","           -4.2529e-01,  1.1046e-01],\n","          ...,\n","          [-8.8420e-01, -7.9446e-01,  4.1551e-01,  ..., -4.6903e-01,\n","           -6.8713e-02, -1.0250e+00],\n","          [ 3.2928e-01,  8.6449e-01, -1.2688e-01,  ..., -3.3192e-01,\n","            5.5505e-02,  6.1652e-02],\n","          [-4.6338e-01, -3.5033e-03,  5.0758e-01,  ..., -2.7231e-01,\n","           -1.5995e-01, -3.6139e-01]],\n","\n","         [[ 5.5538e-03,  3.4991e-01,  1.0177e-01,  ..., -1.1979e-01,\n","            3.1750e-01, -1.4276e-03],\n","          [-2.8577e-01, -3.7413e-01,  5.6204e-02,  ...,  1.1666e+00,\n","            7.1275e-01, -6.2411e-01],\n","          [-1.1684e-01,  4.7682e-01,  2.3216e-02,  ...,  3.0854e-01,\n","           -6.5125e-01, -5.6770e-02],\n","          ...,\n","          [-8.5874e-01, -1.9145e-01,  5.6338e-01,  ..., -2.3906e-01,\n","           -8.3751e-01, -5.0590e-01],\n","          [-7.3099e-01, -8.4202e-01, -9.4192e-01,  ...,  3.3352e-01,\n","            1.4611e-01, -7.2963e-02],\n","          [-4.5255e-02, -1.8640e-01,  5.4239e-01,  ..., -3.9327e-01,\n","            5.1408e-01, -1.2213e-01]],\n","\n","         [[ 1.1537e-01,  9.1011e-02, -3.2837e-01,  ..., -1.6661e-01,\n","            7.4999e-02, -3.1191e-01],\n","          [ 3.1288e-01,  4.1892e-01,  6.1371e-01,  ...,  5.4697e-02,\n","            4.1355e-01, -4.4439e-02],\n","          [-5.8113e-01, -4.7506e-01,  4.9388e-01,  ..., -5.8192e-01,\n","            5.3211e-01,  1.1991e-02],\n","          ...,\n","          [ 2.0654e-01,  3.1053e-01, -7.7465e-01,  ...,  8.0312e-02,\n","           -5.3656e-02,  7.7533e-02],\n","          [ 5.6278e-02, -5.6392e-02, -2.0461e-01,  ..., -1.1607e+00,\n","            3.4064e-01,  4.0667e-01],\n","          [-9.3616e-01, -1.3879e-01, -3.3211e-01,  ...,  2.2152e-01,\n","           -4.9329e-01, -4.9173e-01]],\n","\n","         ...,\n","\n","         [[ 5.0507e-01,  1.2561e-01,  3.8213e-01,  ...,  1.1323e-01,\n","            2.4033e-01, -1.1336e-01],\n","          [ 7.6243e-02, -6.2952e-01,  6.3394e-01,  ..., -5.9346e-02,\n","            6.4537e-01, -2.9881e-01],\n","          [ 5.7309e-01, -3.0106e-01, -1.1556e-01,  ..., -2.5536e-02,\n","            3.5142e-01, -1.9237e-01],\n","          ...,\n","          [-7.0873e-01,  5.9155e-01,  8.0669e-01,  ..., -1.4264e-01,\n","           -1.8270e-01,  5.2766e-01],\n","          [-4.0369e-01, -1.8718e-01, -2.7990e-01,  ...,  1.1405e-01,\n","           -2.6043e-02,  4.3237e-01],\n","          [ 1.7169e-01, -3.1135e-02, -2.1260e-01,  ..., -3.6992e-01,\n","            3.3126e-01, -3.8467e-02]],\n","\n","         [[-3.9746e-01, -4.8549e-01,  1.7230e-01,  ...,  4.7795e-01,\n","            3.6268e-01,  6.9875e-02],\n","          [ 7.8750e-02,  1.8937e-01, -4.6059e-02,  ...,  3.1859e-02,\n","           -1.4290e-01,  4.0194e-02],\n","          [ 1.4368e-01,  1.7650e-01, -4.1156e-01,  ..., -2.3150e-01,\n","           -1.4946e-01,  2.1627e-01],\n","          ...,\n","          [ 4.2747e-02,  1.0574e+00, -5.5863e-01,  ...,  7.6735e-01,\n","           -5.9532e-01, -5.5874e-03],\n","          [ 1.7717e-01, -7.7985e-02, -5.8791e-01,  ...,  4.9209e-01,\n","            7.1700e-01, -1.8532e-01],\n","          [-5.9149e-02,  1.6925e-01,  5.0559e-02,  ...,  4.8233e-01,\n","           -2.5790e-01,  7.2499e-01]],\n","\n","         [[ 1.6609e-01,  3.4551e-02,  3.4262e-01,  ..., -6.9151e-01,\n","           -2.8695e-02,  9.1107e-02],\n","          [-1.3156e-01,  2.0625e-01, -1.8580e-01,  ..., -2.8192e-01,\n","            1.6489e-01, -2.1084e-01],\n","          [-2.9074e-01, -2.0832e-01,  5.7259e-01,  ...,  3.7658e-01,\n","           -1.1233e+00,  4.3784e-02],\n","          ...,\n","          [-5.4302e-01,  6.5209e-01,  2.8733e-02,  ...,  1.2946e-01,\n","            2.8537e-01,  7.9515e-01],\n","          [ 2.2564e-01, -6.5131e-03, -7.8996e-01,  ...,  3.5351e-01,\n","           -3.9409e-01,  6.3983e-01],\n","          [-4.1576e-03,  6.3888e-01, -7.2656e-02,  ...,  6.1214e-01,\n","           -2.1183e-01, -5.8831e-02]]],\n","\n","\n","        [[[ 1.9487e-01, -5.0321e-01, -3.7770e-01,  ..., -3.1008e-01,\n","            1.1860e-01, -5.7568e-01],\n","          [-1.9193e-01,  7.9725e-01, -2.8335e-01,  ...,  4.6032e-02,\n","           -3.4530e-02,  7.1822e-02],\n","          [ 2.8216e-02, -3.0249e-01,  3.4388e-01,  ..., -1.8322e-01,\n","           -7.3261e-01, -4.6944e-01],\n","          ...,\n","          [ 1.1183e-01, -1.2413e-01,  2.8996e-01,  ...,  4.0011e-01,\n","           -8.0166e-01,  1.8516e-01],\n","          [-1.0981e-01, -2.9385e-01, -2.6884e-01,  ..., -3.8974e-01,\n","            1.4369e-01, -1.8256e-01],\n","          [-2.9568e-01, -7.4554e-01, -2.6293e-01,  ...,  2.6285e-01,\n","           -1.9106e-01,  3.6345e-01]],\n","\n","         [[-2.9925e-01, -5.6061e-03,  5.7606e-02,  ...,  4.3960e-01,\n","           -8.0411e-01,  1.8950e-01],\n","          [ 5.3189e-01,  3.3414e-01, -8.9712e-02,  ..., -5.3871e-01,\n","           -9.8986e-02, -2.8797e-02],\n","          [-1.5889e-01,  5.3262e-01, -9.0847e-01,  ...,  1.7293e-01,\n","           -3.8349e-01, -6.4469e-03],\n","          ...,\n","          [ 5.2889e-01,  5.7277e-01, -4.7314e-01,  ..., -6.4281e-01,\n","           -3.3326e-01, -5.5662e-01],\n","          [ 8.4323e-01, -1.7269e-01,  3.5671e-02,  ...,  3.0037e-01,\n","            5.7270e-02, -7.2736e-02],\n","          [ 1.3255e-01, -1.3549e-01,  2.5623e-01,  ..., -2.8575e-01,\n","           -2.6552e-01,  3.4469e-01]],\n","\n","         [[-4.7663e-01, -1.7110e-01,  2.9253e-01,  ..., -3.0068e-01,\n","           -3.4572e-01, -2.7322e-01],\n","          [-1.6573e-01,  3.8715e-01, -5.9361e-02,  ...,  1.2140e-01,\n","           -1.3255e-01,  2.0808e-01],\n","          [-3.9967e-01, -2.8564e-01, -4.0249e-01,  ...,  8.9666e-01,\n","            2.8853e-01, -4.7723e-01],\n","          ...,\n","          [ 8.8949e-02,  2.2683e-01,  2.3206e-01,  ..., -6.4439e-01,\n","           -8.0292e-02, -9.1470e-02],\n","          [ 3.2167e-01,  4.8988e-02,  2.7872e-01,  ..., -9.6339e-02,\n","            5.9414e-01, -1.1933e-01],\n","          [-1.7326e-01,  2.2035e-01,  1.4510e-01,  ..., -4.4072e-01,\n","            2.5869e-01,  2.2211e-01]],\n","\n","         ...,\n","\n","         [[-4.3187e-01,  1.2099e-01, -5.4245e-01,  ..., -2.3351e-01,\n","           -4.3930e-01,  1.0081e-01],\n","          [-2.5749e-01,  6.4873e-02,  4.7418e-01,  ..., -5.9022e-01,\n","            2.3687e-01,  2.2325e-01],\n","          [-7.6762e-01,  2.3709e-01,  5.4077e-01,  ...,  1.1848e+00,\n","            5.7228e-01,  2.2778e-01],\n","          ...,\n","          [ 2.1472e-01, -2.2696e-01, -8.4973e-01,  ..., -7.4568e-01,\n","            6.8258e-01,  6.6723e-01],\n","          [ 7.1605e-01,  3.9339e-01, -1.1369e+00,  ..., -7.5439e-02,\n","            1.0199e-02,  6.4854e-02],\n","          [-4.0027e-01, -1.8786e-01,  3.0586e-01,  ...,  2.0143e-01,\n","           -1.7466e-01,  3.0366e-01]],\n","\n","         [[-2.6532e-01, -3.3820e-01, -1.5513e-01,  ...,  6.8706e-02,\n","            3.0765e-01,  2.1395e-02],\n","          [ 3.1810e-01,  3.2833e-01,  4.5875e-01,  ..., -3.4220e-01,\n","            3.4613e-02,  4.0375e-02],\n","          [ 1.9587e-01, -1.3506e-02,  4.3393e-01,  ..., -3.7007e-01,\n","           -2.2886e-01,  2.1727e-01],\n","          ...,\n","          [ 4.3655e-01, -4.0075e-02, -3.1700e-01,  ...,  1.8821e-01,\n","            6.2691e-01,  3.5767e-01],\n","          [-5.2846e-02,  3.1740e-01,  2.0799e-01,  ...,  2.7627e-02,\n","            9.3188e-02,  4.1396e-01],\n","          [ 4.0948e-02,  5.3770e-02,  1.7112e-01,  ..., -3.5170e-01,\n","            5.7083e-01,  2.3016e-01]],\n","\n","         [[ 7.5979e-02,  3.0089e-01, -4.9231e-01,  ..., -5.7332e-01,\n","            1.9519e-01,  4.7591e-01],\n","          [-3.5640e-01,  1.1663e-01,  3.0777e-02,  ..., -8.8998e-02,\n","            3.9750e-01, -1.0505e-01],\n","          [ 3.8658e-01, -1.9713e-01,  4.7168e-01,  ..., -5.9104e-01,\n","            5.0178e-01, -4.3161e-01],\n","          ...,\n","          [-1.0900e-01, -1.6077e-01, -1.4059e-01,  ...,  3.0025e-01,\n","           -8.4876e-01,  2.9119e-01],\n","          [ 3.6500e-01, -2.8551e-01,  3.3448e-01,  ..., -7.9343e-02,\n","            5.3278e-01, -3.1351e-01],\n","          [ 3.5514e-01,  1.5784e-01,  2.8147e-01,  ...,  9.0701e-01,\n","           -1.4172e-01,  1.7385e-01]]],\n","\n","\n","        ...,\n","\n","\n","        [[[ 2.3886e-01, -5.9968e-01,  1.7171e-01,  ..., -4.3107e-01,\n","           -2.9638e-01, -1.9669e-02],\n","          [ 8.4338e-01,  4.5326e-01, -3.6209e-01,  ...,  2.9527e-01,\n","           -4.8538e-01,  2.0142e-01],\n","          [ 1.7208e-01, -1.1888e+00,  1.1370e+00,  ...,  8.3028e-01,\n","           -1.4115e-01, -3.9486e-01],\n","          ...,\n","          [ 2.5420e-01,  1.2431e+00,  8.8500e-01,  ..., -8.0892e-01,\n","           -1.6725e-01,  1.3237e-01],\n","          [ 1.3444e-01,  1.6715e-01, -9.1508e-01,  ...,  3.9847e-01,\n","            6.7037e-02, -5.6487e-02],\n","          [ 3.7983e-01, -1.2646e+00, -5.4481e-01,  ...,  1.4829e-01,\n","            2.8423e-01,  4.5482e-01]],\n","\n","         [[-1.2476e-01,  1.2920e-01,  1.9294e-01,  ..., -3.9519e-01,\n","            1.6595e-01, -8.6027e-02],\n","          [-1.4802e-01, -1.9201e-01,  5.4679e-01,  ...,  3.2324e-01,\n","            3.9984e-01, -4.9462e-01],\n","          [-4.1751e-01,  2.7137e-01,  1.0888e-01,  ..., -8.9300e-01,\n","            1.6980e-01,  3.0251e-01],\n","          ...,\n","          [ 4.8258e-01,  6.7656e-02, -6.8734e-01,  ..., -5.4756e-01,\n","            4.0067e-01,  1.4959e-01],\n","          [ 3.4109e-01, -5.1495e-01, -2.5768e-01,  ...,  1.3671e-01,\n","            6.2535e-01,  6.1249e-03],\n","          [-2.4447e-02,  5.0075e-01, -2.7489e-01,  ...,  1.9473e-01,\n","            5.5653e-01,  1.6467e-01]],\n","\n","         [[-8.9077e-02, -1.0920e-01,  1.6866e-01,  ..., -3.3322e-02,\n","            1.0008e-01, -2.7504e-01],\n","          [-2.7172e-02, -1.4276e-01, -1.8520e-01,  ..., -4.5572e-01,\n","            5.4694e-01,  7.6525e-02],\n","          [-1.5906e-01, -5.3105e-01,  4.0024e-01,  ...,  6.6689e-01,\n","            1.0026e-01, -3.6146e-02],\n","          ...,\n","          [-3.0016e-01,  5.6185e-01, -2.6962e-01,  ...,  4.0882e-02,\n","            3.4022e-01,  1.3930e+00],\n","          [-4.4418e-01,  5.6528e-02, -1.7507e-01,  ...,  4.8096e-01,\n","           -4.1060e-01, -5.6567e-01],\n","          [-1.3199e-01,  7.8472e-02,  4.6206e-01,  ..., -1.4570e-01,\n","           -5.0987e-02,  4.4457e-01]],\n","\n","         ...,\n","\n","         [[-4.1813e-01,  2.3312e-01, -2.0006e-01,  ..., -1.4108e-01,\n","           -3.5277e-01, -4.3650e-01],\n","          [ 1.2850e-01,  1.4392e-01,  6.2569e-02,  ..., -8.0097e-02,\n","           -9.6757e-03, -3.6234e-01],\n","          [-1.6194e-02,  5.4524e-02, -2.8831e-02,  ..., -1.1909e+00,\n","            1.7828e-01,  4.3150e-02],\n","          ...,\n","          [-2.2779e-01, -3.0097e-01, -1.0424e+00,  ..., -2.3452e-01,\n","           -1.0554e+00, -1.2589e-01],\n","          [-6.5449e-02, -1.6674e-01, -6.8309e-01,  ...,  4.9188e-01,\n","            3.2257e-01,  2.2244e-01],\n","          [-1.7852e-02,  3.1697e-01, -6.5233e-01,  ..., -5.6316e-01,\n","           -2.7206e-01, -6.7398e-01]],\n","\n","         [[-6.8636e-02, -8.7925e-03,  3.5775e-02,  ..., -1.1082e-01,\n","           -1.1034e-01, -9.2651e-02],\n","          [-5.6480e-02,  3.9422e-02, -2.2188e-01,  ..., -9.2801e-02,\n","           -2.4770e-01,  5.2844e-01],\n","          [ 2.0868e-01,  2.8656e-01, -5.5556e-01,  ..., -1.8794e+00,\n","            3.2012e-01, -2.7238e-01],\n","          ...,\n","          [-5.0383e-02, -1.0468e-01, -1.4657e-01,  ...,  3.1534e-01,\n","           -2.9629e-01, -7.2151e-01],\n","          [ 2.4422e-01,  4.2267e-01, -6.4095e-01,  ..., -6.1294e-01,\n","           -2.9354e-02, -9.2513e-02],\n","          [ 3.1260e-01,  3.2465e-01, -3.6760e-01,  ..., -9.4949e-02,\n","           -5.6410e-01,  1.6696e-01]],\n","\n","         [[-2.9894e-01,  5.1616e-01, -7.7176e-03,  ...,  3.3153e-01,\n","           -1.0288e-01, -1.4822e-01],\n","          [-7.2300e-01, -1.4924e-01,  2.3338e-01,  ..., -5.2460e-01,\n","            5.2527e-03,  4.3539e-01],\n","          [-1.5088e-01, -3.5637e-02,  3.8978e-01,  ...,  1.8677e-02,\n","            1.2448e-01, -3.3152e-01],\n","          ...,\n","          [-7.2295e-02, -2.2143e-01,  3.8368e-01,  ...,  1.5459e+00,\n","            5.7791e-01,  5.9334e-01],\n","          [-6.9819e-01,  6.1950e-01,  3.3468e-01,  ..., -2.4165e-01,\n","           -2.7439e-01,  7.4618e-02],\n","          [ 7.2866e-02,  2.7663e-01,  3.9912e-01,  ...,  5.3209e-02,\n","            2.6506e-01,  1.8482e-01]]],\n","\n","\n","        [[[-6.1774e-02, -2.4233e-01,  1.6169e-01,  ..., -3.2209e-01,\n","           -2.0186e-01, -4.8634e-01],\n","          [-1.3074e-01, -2.2021e-01, -1.0846e+00,  ..., -4.0128e-01,\n","           -2.3982e-01,  5.3426e-01],\n","          [ 6.5087e-02, -4.5079e-01,  3.1445e-01,  ...,  1.0117e-01,\n","           -1.2696e-01,  1.7354e-01],\n","          ...,\n","          [-1.0789e-01, -5.5344e-01,  4.3212e-01,  ..., -1.1179e+00,\n","           -1.7251e-01,  3.4600e-01],\n","          [-8.3670e-01, -2.7006e-01,  1.1946e+00,  ..., -4.1826e-01,\n","           -6.8916e-01, -1.5734e-01],\n","          [ 1.0849e-01, -1.4778e-01, -1.6328e-02,  ...,  2.4485e-01,\n","           -7.1730e-01,  1.7531e-01]],\n","\n","         [[ 1.8241e-01,  3.5873e-01, -7.8910e-01,  ...,  1.8250e-01,\n","            1.9049e-01, -1.8359e-01],\n","          [ 1.3944e-01, -3.4649e-01,  5.3419e-01,  ..., -2.7546e-01,\n","           -3.2229e-01,  3.2649e-02],\n","          [-4.9199e-01, -9.5631e-01, -8.3188e-01,  ...,  5.0287e-01,\n","            5.2716e-01,  1.8845e-01],\n","          ...,\n","          [-1.6255e-01,  1.9388e-01,  1.1648e+00,  ..., -4.0432e-01,\n","            5.9580e-01, -2.7071e-01],\n","          [ 4.4858e-01,  4.8128e-01,  3.8733e-01,  ..., -2.6129e-01,\n","            6.8638e-01, -6.1273e-01],\n","          [-6.3249e-01,  2.1705e-01, -7.0647e-01,  ...,  7.7639e-03,\n","            4.1155e-01,  5.0359e-01]],\n","\n","         [[-2.2862e-01, -3.9194e-01, -5.9378e-02,  ..., -2.7963e-01,\n","           -1.3582e-01, -6.6536e-02],\n","          [ 2.0855e-02, -9.0083e-01, -2.7898e-01,  ..., -7.2254e-01,\n","            3.0627e-01, -2.4899e-01],\n","          [-3.6350e-01, -4.8994e-01, -7.3805e-02,  ..., -2.6015e-01,\n","            6.7746e-01,  8.0662e-03],\n","          ...,\n","          [-3.9083e-01,  4.1229e-01, -6.7107e-01,  ..., -7.4163e-01,\n","           -9.6049e-01,  5.2954e-02],\n","          [-6.0749e-01, -2.1090e-01, -5.7277e-01,  ...,  5.9032e-02,\n","            1.0811e-01,  1.4932e-01],\n","          [-6.4918e-01, -5.4605e-01, -2.6573e-01,  ...,  2.2402e-01,\n","            2.5699e-01,  3.7206e-01]],\n","\n","         ...,\n","\n","         [[-1.2444e-01, -3.6129e-01, -8.0820e-01,  ...,  2.6933e-01,\n","            2.9846e-01, -2.6579e-01],\n","          [ 1.1373e-01,  2.8371e-01,  3.8802e-01,  ..., -1.3505e-01,\n","           -4.3500e-01, -1.0839e-01],\n","          [-1.8495e-01,  2.1077e-01, -7.2704e-01,  ...,  4.3276e-01,\n","           -3.1359e-02, -4.8473e-01],\n","          ...,\n","          [ 3.3466e-01,  2.7573e-01, -3.8690e-01,  ...,  5.0718e-01,\n","           -1.8650e-02, -7.8077e-01],\n","          [ 1.7711e-01,  3.2532e-01, -7.7041e-02,  ..., -6.6224e-01,\n","            7.2240e-01, -3.6895e-01],\n","          [-3.6695e-01,  2.6019e-01, -5.3657e-01,  ...,  8.8320e-01,\n","            3.6191e-01, -2.6852e-01]],\n","\n","         [[-3.1354e-01,  1.6833e-01,  5.2290e-02,  ...,  2.4766e-01,\n","            2.9001e-01,  3.4096e-01],\n","          [ 4.8554e-01, -1.1325e-01, -8.4525e-01,  ..., -1.1284e-01,\n","           -2.7533e-01, -6.0412e-02],\n","          [ 1.4224e-01,  2.8827e-01, -5.1780e-01,  ...,  1.4254e-01,\n","           -1.0440e-01,  1.5438e-02],\n","          ...,\n","          [ 2.5504e-01, -6.0399e-02,  1.7502e-01,  ..., -2.8765e-01,\n","           -4.1586e-01,  5.4119e-01],\n","          [-9.8034e-02, -2.1407e-01,  1.7054e-01,  ..., -3.8716e-01,\n","            9.3543e-02, -1.0028e+00],\n","          [ 4.5314e-01, -6.1645e-01, -3.3807e-01,  ...,  3.8288e-01,\n","            6.0698e-01, -9.4693e-02]],\n","\n","         [[ 2.3684e-01, -3.9613e-01, -4.6997e-01,  ...,  3.2760e-01,\n","            3.8431e-01, -3.3116e-01],\n","          [-1.5390e-01,  5.1868e-01, -4.6942e-01,  ..., -8.7823e-01,\n","            2.3248e-03, -2.1237e-01],\n","          [ 4.0167e-01, -9.1607e-02, -6.0147e-01,  ..., -3.9331e-01,\n","            1.7855e-02, -3.0475e-02],\n","          ...,\n","          [-2.1469e-01, -9.4483e-01,  4.0403e-02,  ..., -6.2516e-01,\n","            4.1884e-01, -3.7264e-01],\n","          [-2.3876e-01,  3.9432e-02, -7.2484e-02,  ...,  4.3143e-01,\n","            1.1584e-01,  3.5324e-01],\n","          [ 4.7663e-01, -1.2592e-01, -2.5498e-01,  ..., -1.7843e-01,\n","           -6.4955e-01,  1.5563e-01]]],\n","\n","\n","        [[[ 6.9246e-02,  1.3006e-01, -2.6026e-01,  ...,  4.5323e-02,\n","            1.1288e-01,  2.3947e-01],\n","          [ 1.2017e-01,  3.0263e-01, -3.3140e-01,  ...,  9.7582e-01,\n","            3.8902e-01, -2.8413e-01],\n","          [-1.6386e-01,  1.5568e-01,  3.9232e-01,  ..., -4.8801e-01,\n","           -7.7581e-01, -9.4352e-02],\n","          ...,\n","          [ 3.0896e-01, -6.4954e-01,  8.1546e-01,  ...,  1.4204e-01,\n","           -6.4383e-01,  6.2878e-01],\n","          [-8.7804e-01, -2.8278e-01, -5.7056e-01,  ...,  6.1659e-01,\n","           -3.5947e-01, -5.0732e-01],\n","          [-3.5520e-01, -8.1486e-01, -3.7545e-01,  ...,  7.5433e-01,\n","           -4.5663e-01,  4.7090e-01]],\n","\n","         [[ 3.4219e-01,  3.3520e-01,  5.7817e-01,  ..., -1.8398e-01,\n","           -6.9313e-02, -4.8850e-02],\n","          [ 4.2016e-01,  3.1770e-02, -3.1171e-01,  ..., -9.9887e-01,\n","           -2.7863e-01, -7.6430e-02],\n","          [ 3.8991e-01,  7.8683e-01, -5.7697e-01,  ...,  1.5996e-01,\n","           -5.4364e-01, -4.0932e-01],\n","          ...,\n","          [-9.8408e-01, -1.6910e-01, -8.2875e-02,  ..., -4.1709e-01,\n","            6.1764e-01,  8.5915e-01],\n","          [ 6.8637e-01, -6.2560e-01,  4.8299e-01,  ...,  4.2950e-01,\n","            1.6289e-01, -1.8834e-01],\n","          [-2.3503e-01, -4.4569e-02,  2.7599e-01,  ..., -3.2202e-01,\n","           -7.5506e-01,  6.6786e-02]],\n","\n","         [[-2.6371e-01, -3.0643e-01,  8.2280e-02,  ..., -3.4624e-01,\n","           -3.9885e-01,  1.3691e-01],\n","          [-4.6315e-01,  5.5301e-01, -3.8730e-01,  ...,  5.5176e-01,\n","           -6.0410e-01,  3.6309e-02],\n","          [-3.5821e-01, -2.2940e-01, -1.3272e-01,  ..., -1.1529e+00,\n","           -2.5942e-01,  1.1801e-01],\n","          ...,\n","          [ 3.1281e-01,  4.1285e-01, -7.6387e-01,  ..., -4.6614e-02,\n","            2.8515e-01, -1.6649e-02],\n","          [ 1.6494e-01, -2.5348e-02,  2.7540e-01,  ..., -1.0207e+00,\n","            1.2902e-01, -2.8766e-01],\n","          [-6.1719e-02, -4.6432e-01,  3.5059e-01,  ..., -1.1153e+00,\n","           -2.7948e-02, -4.9630e-01]],\n","\n","         ...,\n","\n","         [[ 3.1103e-01, -2.5061e-01, -5.2800e-01,  ...,  3.8996e-01,\n","            1.8943e-01, -2.5640e-01],\n","          [ 5.0139e-02, -5.7475e-01, -2.7233e-01,  ..., -8.1901e-02,\n","            3.0671e-01,  6.7833e-02],\n","          [ 5.0432e-01,  4.4371e-01,  1.2765e+00,  ...,  2.5113e-01,\n","            2.9371e-01,  5.7063e-01],\n","          ...,\n","          [-3.1454e-01,  1.9678e-01,  7.7547e-02,  ..., -3.1666e-02,\n","            3.7387e-01,  4.7035e-01],\n","          [-2.1071e-03, -7.8298e-01, -4.8349e-01,  ..., -5.3141e-02,\n","           -4.9161e-01,  1.6294e-01],\n","          [-5.0898e-01,  7.1136e-01,  1.0682e-01,  ..., -5.1859e-02,\n","           -6.1689e-02,  2.2526e-01]],\n","\n","         [[-3.4960e-02,  4.1477e-02, -8.0108e-01,  ..., -2.2982e-01,\n","            5.5956e-01, -2.2418e-01],\n","          [-1.1516e-02,  3.5720e-01, -1.1795e-01,  ..., -1.0321e-01,\n","           -3.9299e-01,  6.7317e-01],\n","          [ 5.4006e-01, -2.1569e-01,  4.2571e-01,  ..., -4.3072e-01,\n","            1.1896e-01, -4.7912e-01],\n","          ...,\n","          [ 1.0750e-01, -3.4032e-01,  7.2527e-02,  ..., -5.3944e-01,\n","           -8.0694e-01, -3.7787e-01],\n","          [ 3.3658e-01, -8.3405e-01,  3.2517e-01,  ..., -3.6272e-01,\n","           -8.7640e-02,  2.8882e-01],\n","          [-1.3669e-02, -3.9207e-01,  1.7507e-03,  ..., -1.7559e-01,\n","            1.9722e-01, -7.8651e-02]],\n","\n","         [[ 1.4975e-01, -3.5739e-01,  1.3835e-01,  ...,  1.8390e-01,\n","           -5.1356e-01, -1.9001e-01],\n","          [ 1.2768e-01, -4.1077e-01,  2.0332e-01,  ...,  1.6190e-01,\n","           -1.0591e-01, -2.6150e-02],\n","          [-2.7896e-01, -1.1280e+00, -1.3118e-02,  ...,  7.4388e-01,\n","            4.7757e-01, -5.0676e-02],\n","          ...,\n","          [ 4.4360e-02,  5.5905e-01,  5.9351e-02,  ...,  1.0412e+00,\n","            2.2936e-01,  3.3629e-01],\n","          [ 3.7863e-01, -5.3531e-01, -9.6626e-02,  ...,  5.9924e-02,\n","            5.4300e-01,  3.6998e-01],\n","          [-5.9933e-01, -6.2628e-01,  7.5116e-01,  ..., -7.4737e-02,\n","           -3.6393e-01, -3.4526e-01]]]], grad_fn=<SlowConvDilated2DBackward>)\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"RLqGbclbp3_N","executionInfo":{"status":"ok","timestamp":1603774974783,"user_tz":-540,"elapsed":12885,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"b523c0b0-2f0c-4de4-cf62-76ff4bbfebfd","colab":{"base_uri":"https://localhost:8080/","height":35}},"source":["output.shape"],"execution_count":72,"outputs":[{"output_type":"execute_result","data":{"text/plain":["torch.Size([20, 33, 26, 100])"]},"metadata":{"tags":[]},"execution_count":72}]},{"cell_type":"markdown","metadata":{"id":"CYeGAJEuneqW"},"source":["### nn.functional 패키지\n","\n","- 가중치를 직접 선언하여 인자로 넣어줘야함\n","\n","- 예시)\n","  - Convolution functions\n","\n","  - Pooling functions\n","  \n","  - Non-linear activation functions\n","\n","  - Normalization functions\n","\n","  - Linear functions\n","\n","  - Dropout functions\n","  \n","  - Sparse functions\n","  \n","  - Distance functions\n","\n","  - Loss functions\n","  - ..\n","\n","- https://pytorch.org/docs/stable/nn.functional.html"]},{"cell_type":"code","metadata":{"id":"NpwbO9Dhpflm","executionInfo":{"status":"ok","timestamp":1603774974783,"user_tz":-540,"elapsed":12876,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}}},"source":["import torch\n","import torch.nn.functional as F"],"execution_count":73,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"fUYaJ5aLqKed"},"source":["- Convolution Layer 예시 (2)"]},{"cell_type":"code","metadata":{"id":"GAWLQE2GouHP","executionInfo":{"status":"ok","timestamp":1603774974783,"user_tz":-540,"elapsed":12864,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}}},"source":["filters = torch.randn(8, 4, 3 ,3)"],"execution_count":74,"outputs":[]},{"cell_type":"code","metadata":{"id":"lWmSlFBrpms1","executionInfo":{"status":"ok","timestamp":1603774974784,"user_tz":-540,"elapsed":12856,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"09fc38ea-ec85-40d0-a72b-3ab81142ff15","colab":{"base_uri":"https://localhost:8080/","height":35}},"source":["inputs = torch.randn(1,4,5,5)\n","conv = F.conv2d(inputs, filters, padding=1)\n","conv.shape"],"execution_count":75,"outputs":[{"output_type":"execute_result","data":{"text/plain":["torch.Size([1, 8, 5, 5])"]},"metadata":{"tags":[]},"execution_count":75}]},{"cell_type":"markdown","metadata":{"id":"Wah4RsmgrRDP"},"source":["## Torchvision\n","\n","- `transforms`: 전처리할 때 사용하는 메소드\n","\n","- `transforms`에서 제공하는 클래스 이외에  \n","  일반적으로 클래스를 따로 만들어 전처리 단계를 진행\n","  \n","  - 아래의 코드에서 다양한 전처리 기술 확인  \n","    https://pytorch.org/docs/stable/torchvision/transforms.html\n"]},{"cell_type":"code","metadata":{"id":"akvq4QWmqSil","executionInfo":{"status":"ok","timestamp":1603774974784,"user_tz":-540,"elapsed":12847,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}}},"source":["import torch\n","import torchvision\n","import torchvision.transforms as transforms"],"execution_count":76,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"PKu5mzyTs-Qj"},"source":["- 예시)\n","  - `DataLoader`의 인자로 들어갈 `transform`을 미리 정의할 수 있음\n","\n","  - `Compose`를 통해 리스트 안에 순서대로 전처리 진행\n","\n","  - 대표적인 예로, `ToTensor`()를 하는 이유는  \n","   <u>torchvision이 PIL Image형태로만 입력을 받기 때문에</u> 데이터 처리를 위해서 Tensor형으로 변환해야함"]},{"cell_type":"code","metadata":{"id":"y6K7FH-Rs9my","executionInfo":{"status":"ok","timestamp":1603774974785,"user_tz":-540,"elapsed":12838,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}}},"source":["transform = transforms.Compose([transforms.ToTensor(),\n","                                transforms.Normalize(mean=(0.5), std=(0.5,))])"],"execution_count":77,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"I4l1GvIlslKa"},"source":["## utils.data\n","\n","- `Dataset`에는 다양한 데이터셋이 존재  \n","  - MNIST, CIFAR10, ...\n","\n","- `DataLoader`, `Dataset`을 통해  \n","  `batch_size`, `train`여부, `transform`등을 인자로 넣어 데이터를 어떻게 load할 것인지 정해줄 수 있음"]},{"cell_type":"code","metadata":{"id":"1wsZKY7-s2Vv","executionInfo":{"status":"ok","timestamp":1603774974785,"user_tz":-540,"elapsed":12827,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}}},"source":["import torch\n","from torch.utils.data import Dataset, DataLoader\n","\n","import torchvision\n","import torchvision.transforms as transforms"],"execution_count":78,"outputs":[]},{"cell_type":"code","metadata":{"id":"lldpI2lquBu3","executionInfo":{"status":"ok","timestamp":1603774978084,"user_tz":-540,"elapsed":16116,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"2d97f0ab-7afd-4b62-ae97-d2fe2bf95198","colab":{"base_uri":"https://localhost:8080/","height":417,"referenced_widgets":["196c0d0b111b40caa7cf9979beea4f07","add36eeca2374a09b06f9d087de1c06b","c9d629304aa24fb0b02d89f9f3d529cc","56854687680745378f5640b6c1f374d8","e8d219007a71416c81a1cccdcf1f39f6","5fba39a8943a4a07b65ad2065e67ef9e","fe7fc14943b0401b96dc07fe816e4523","41c6e3f7786847869f279294c81c4ff7","3bc494cd83f3499c8fd7dfee406000d6","2b4be5875995411cb453fdad5c6fa43d","cb008c4534144528b4afd18cbdbd36a6","d2f8f30ac51e48049a68fc7a964b2635","897174e371f445c6b21c4f5adef3898c","b7761fcb65924ac4a11ef18a5d1350f7","c587b547fa4547cdbee521580347bde6","56cfd358e2c04aa3a483639ffaba4c74","2c3a9c43df4441988e25b1f199f9d573","439679226d0c4e2c9e718773d0f0cec2","3b9c7c9b67c742ce88957302336872bb","04858037e7d94d9b8adadb45233787c1","eee7cc0cbc704f6babed43e3f193e21d","a54583b4a3f7494a885bf57a129e2a8d","476abf92ac4b4d209168276ad5050c11","605bd3e570e14650976b0d9be582d02a","1f21f6289c3d4770b1e38e43adfd5726","a67c2ae7217e4fe5ac96aca2fc256a48","7d5c6d0763154a7aa7c81b1a7eb48147","d9c2e708178f4ad3b275e0e2a0e4c1b5","3f2d16d6e3a34fd5bed971c1a1577a5d","4bbc199561d54636a9d3752cc4ee4e5a","ddd145a6319c49ed9cef8aaa4f0ad5e7","7606eb4d4b7e4d43a831f47eb1783c3d"]}},"source":["trainset = torchvision.datasets.MNIST(root='/content/',\n","                                     train=True,\n","                                     download=True,\n","                                     transform=transform)\n","\n","testset = torchvision.datasets.MNIST(root='/content/',\n","                                     train=False,\n","                                     download=True,\n","                                     transform=transform)"],"execution_count":79,"outputs":[{"output_type":"stream","text":["Downloading http://yann.lecun.com/exdb/mnist/train-images-idx3-ubyte.gz to /content/MNIST/raw/train-images-idx3-ubyte.gz\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"196c0d0b111b40caa7cf9979beea4f07","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=1.0, bar_style='info', max=1.0), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["Extracting /content/MNIST/raw/train-images-idx3-ubyte.gz to /content/MNIST/raw\n","Downloading http://yann.lecun.com/exdb/mnist/train-labels-idx1-ubyte.gz to /content/MNIST/raw/train-labels-idx1-ubyte.gz\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"3bc494cd83f3499c8fd7dfee406000d6","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=1.0, bar_style='info', max=1.0), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["Extracting /content/MNIST/raw/train-labels-idx1-ubyte.gz to /content/MNIST/raw\n","Downloading http://yann.lecun.com/exdb/mnist/t10k-images-idx3-ubyte.gz to /content/MNIST/raw/t10k-images-idx3-ubyte.gz\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"2c3a9c43df4441988e25b1f199f9d573","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=1.0, bar_style='info', max=1.0), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["Extracting /content/MNIST/raw/t10k-images-idx3-ubyte.gz to /content/MNIST/raw\n","Downloading http://yann.lecun.com/exdb/mnist/t10k-labels-idx1-ubyte.gz to /content/MNIST/raw/t10k-labels-idx1-ubyte.gz\n","\n","\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"1f21f6289c3d4770b1e38e43adfd5726","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=1.0, bar_style='info', max=1.0), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["Extracting /content/MNIST/raw/t10k-labels-idx1-ubyte.gz to /content/MNIST/raw\n","Processing...\n","Done!\n"],"name":"stdout"},{"output_type":"stream","text":["/usr/local/lib/python3.6/dist-packages/torchvision/datasets/mnist.py:469: UserWarning: The given NumPy array is not writeable, and PyTorch does not support non-writeable tensors. This means you can write to the underlying (supposedly non-writeable) NumPy array using the tensor. You may want to copy the array to protect its data or make it writeable before converting it to a tensor. This type of warning will be suppressed for the rest of this program. (Triggered internally at  /pytorch/torch/csrc/utils/tensor_numpy.cpp:141.)\n","  return torch.from_numpy(parsed.astype(m[2], copy=False)).view(*s)\n"],"name":"stderr"}]},{"cell_type":"code","metadata":{"id":"fKddZnT1uQmT","executionInfo":{"status":"ok","timestamp":1603774978085,"user_tz":-540,"elapsed":16107,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}}},"source":["train_loader = DataLoader(trainset, batch_size=8, shuffle=True, num_workers=2)\n","test_loader = DataLoader(testset, batch_size=8, shuffle=False, num_workers=2)"],"execution_count":80,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"zrxymquLxeo8"},"source":["- `batch_size`만큼 데이터를 하나씩 가져옴"]},{"cell_type":"code","metadata":{"id":"hvgMIyF6uUuU","executionInfo":{"status":"ok","timestamp":1603774978085,"user_tz":-540,"elapsed":16095,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"c3ea5197-98f7-4b00-a5a1-23e1824c3b08","colab":{"base_uri":"https://localhost:8080/","height":35}},"source":["dataiter = iter(train_loader)\n","images, labels = dataiter.next()\n","images.shape, labels.shape"],"execution_count":81,"outputs":[{"output_type":"execute_result","data":{"text/plain":["(torch.Size([8, 1, 28, 28]), torch.Size([8]))"]},"metadata":{"tags":[]},"execution_count":81}]},{"cell_type":"markdown","metadata":{"id":"YPUC0a0aw6OM"},"source":["<u>**(중요) torch에서는 channel(채널)이 앞에 옴**</u>\n","\n","- `channel first`\n","\n","- tensorflow, keras 등에서는 channel이 뒤에 옴(`channel last`)"]},{"cell_type":"markdown","metadata":{"id":"wuhylD3iyFYr"},"source":["### 데이터 확인"]},{"cell_type":"code","metadata":{"id":"C9hAQmQlul8P","executionInfo":{"status":"ok","timestamp":1603774978086,"user_tz":-540,"elapsed":16086,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}}},"source":["import matplotlib.pyplot as plt\n","plt.style.use(['seaborn-white'])"],"execution_count":82,"outputs":[]},{"cell_type":"code","metadata":{"id":"zDcUY6o4xUQp","executionInfo":{"status":"ok","timestamp":1603774978086,"user_tz":-540,"elapsed":16077,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"bae00190-a449-4dfb-c25e-6948da7600b0","colab":{"base_uri":"https://localhost:8080/","height":35}},"source":["torch_image = torch.squeeze(images[0])\n","torch_image.shape"],"execution_count":83,"outputs":[{"output_type":"execute_result","data":{"text/plain":["torch.Size([28, 28])"]},"metadata":{"tags":[]},"execution_count":83}]},{"cell_type":"code","metadata":{"id":"MZmPWiGbxoiW","executionInfo":{"status":"ok","timestamp":1603774978086,"user_tz":-540,"elapsed":16066,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"9bac1bf6-7b1f-4e9f-e418-76e0e447a525","colab":{"base_uri":"https://localhost:8080/","height":35}},"source":["image = torch_image.numpy()\n","image.shape"],"execution_count":84,"outputs":[{"output_type":"execute_result","data":{"text/plain":["(28, 28)"]},"metadata":{"tags":[]},"execution_count":84}]},{"cell_type":"code","metadata":{"id":"AUOdd4UaxaXO","executionInfo":{"status":"ok","timestamp":1603774978087,"user_tz":-540,"elapsed":16059,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"33062477-dd8f-4674-b96c-03fc279be801","colab":{"base_uri":"https://localhost:8080/","height":35}},"source":["label = labels[0].numpy()\n","label.shape"],"execution_count":85,"outputs":[{"output_type":"execute_result","data":{"text/plain":["()"]},"metadata":{"tags":[]},"execution_count":85}]},{"cell_type":"code","metadata":{"id":"PDQfjw4wxr1z","executionInfo":{"status":"ok","timestamp":1603774978087,"user_tz":-540,"elapsed":16048,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"392d232f-02d5-46a9-c62f-3167da650dde","colab":{"base_uri":"https://localhost:8080/","height":35}},"source":["label"],"execution_count":86,"outputs":[{"output_type":"execute_result","data":{"text/plain":["array(5)"]},"metadata":{"tags":[]},"execution_count":86}]},{"cell_type":"code","metadata":{"id":"JDCVw59ax3-A","executionInfo":{"status":"ok","timestamp":1603774978088,"user_tz":-540,"elapsed":16037,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"c49a5bd3-3801-425f-86fb-c6f5d2b19c1a","colab":{"base_uri":"https://localhost:8080/","height":295}},"source":["plt.title(label)\n","plt.imshow(image, 'gray')\n","plt.show()"],"execution_count":87,"outputs":[{"output_type":"display_data","data":{"image/png":"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\n","text/plain":["<Figure size 432x288 with 1 Axes>"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"JVcWQlxzihtS"},"source":["## 각 Layer 설명"]},{"cell_type":"code","metadata":{"id":"IGXn1_weif5H","executionInfo":{"status":"ok","timestamp":1603774978088,"user_tz":-540,"elapsed":16027,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}}},"source":["import torch\n","import torch.nn as nn\n","import torch.nn.functional as F\n","import torch.optim as optim"],"execution_count":88,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"73kJ3heBi26y"},"source":["### nn.Conv2d\n","\n","- `in_channels`: channel의 갯수\n","\n","- `out_channels`: 출력 채널의 갯수\n","\n","- `kernel_size`: 커널(필터) 사이즈\n","\n","- 텐서플로우, 케라스와 다르게 레이어의 `input`인자에도 값을 집어 넣어줘야함"]},{"cell_type":"code","metadata":{"id":"RcHJguyFipTl","executionInfo":{"status":"ok","timestamp":1603774978089,"user_tz":-540,"elapsed":16019,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"6aa72910-c0c0-42d7-d2f0-3454dcd2b479","colab":{"base_uri":"https://localhost:8080/","height":35}},"source":["nn.Conv2d(in_channels=1, out_channels=20, kernel_size=5, stride=1)"],"execution_count":89,"outputs":[{"output_type":"execute_result","data":{"text/plain":["Conv2d(1, 20, kernel_size=(5, 5), stride=(1, 1))"]},"metadata":{"tags":[]},"execution_count":89}]},{"cell_type":"code","metadata":{"id":"iWiJbViHjFG0","executionInfo":{"status":"ok","timestamp":1603774978737,"user_tz":-540,"elapsed":16657,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"ecb82a84-143d-4bf5-e9c9-51771467f11f","colab":{"base_uri":"https://localhost:8080/","height":35}},"source":["layer = nn.Conv2d(1, 20, 5, 1).to(torch.device(\"cpu\"))\n","layer"],"execution_count":90,"outputs":[{"output_type":"execute_result","data":{"text/plain":["Conv2d(1, 20, kernel_size=(5, 5), stride=(1, 1))"]},"metadata":{"tags":[]},"execution_count":90}]},{"cell_type":"markdown","metadata":{"id":"GxWYFm2xjUeN"},"source":["- `wegiht`확인"]},{"cell_type":"code","metadata":{"id":"za0enRbyjPzV","executionInfo":{"status":"ok","timestamp":1603774978738,"user_tz":-540,"elapsed":16647,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"ebb230c0-81ad-41fc-f91a-80daa598c4eb","colab":{"base_uri":"https://localhost:8080/","height":35}},"source":["weight = layer.weight\n","weight.shape"],"execution_count":91,"outputs":[{"output_type":"execute_result","data":{"text/plain":["torch.Size([20, 1, 5, 5])"]},"metadata":{"tags":[]},"execution_count":91}]},{"cell_type":"markdown","metadata":{"id":"MAZcTU2gjiCX"},"source":["- `weight`는 `detach()`를 통해 꺼내줘야 `numpy()`변환이 가능"]},{"cell_type":"code","metadata":{"id":"9eN_oUBkjT85","executionInfo":{"status":"ok","timestamp":1603774978738,"user_tz":-540,"elapsed":16638,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}}},"source":["weight = weight.detach()"],"execution_count":92,"outputs":[]},{"cell_type":"code","metadata":{"id":"kwso9tsijmz8","executionInfo":{"status":"ok","timestamp":1603774978739,"user_tz":-540,"elapsed":16631,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"a829d0e7-ad4e-43f5-9690-e0371364719a","colab":{"base_uri":"https://localhost:8080/","height":35}},"source":["weight = weight.numpy()\n","weight.shape"],"execution_count":93,"outputs":[{"output_type":"execute_result","data":{"text/plain":["(20, 1, 5, 5)"]},"metadata":{"tags":[]},"execution_count":93}]},{"cell_type":"code","metadata":{"id":"mUegf6HPjdPl","executionInfo":{"status":"ok","timestamp":1603774978739,"user_tz":-540,"elapsed":16612,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"10523efd-4456-4d99-dfca-7b6e88b25112","colab":{"base_uri":"https://localhost:8080/","height":262}},"source":["plt.imshow(weight[0,0, :,:], 'jet')\n","plt.colorbar()\n","plt.show()"],"execution_count":94,"outputs":[{"output_type":"display_data","data":{"image/png":"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\n","text/plain":["<Figure size 432x288 with 2 Axes>"]},"metadata":{"tags":[]}}]},{"cell_type":"code","metadata":{"id":"DMeTOqVmcdWa","executionInfo":{"status":"ok","timestamp":1603774978739,"user_tz":-540,"elapsed":16591,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"46d14df9-9106-4658-a369-7b2f86c2cbf4","colab":{"base_uri":"https://localhost:8080/","height":35}},"source":["print(images.shape)"],"execution_count":95,"outputs":[{"output_type":"stream","text":["torch.Size([8, 1, 28, 28])\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"cvolnNsscdHs","executionInfo":{"status":"ok","timestamp":1603774978740,"user_tz":-540,"elapsed":16562,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}}},"source":["input_image = torch.unsqueeze(images[0], dim=0)"],"execution_count":96,"outputs":[]},{"cell_type":"code","metadata":{"id":"NLOAfD5mjup1","executionInfo":{"status":"ok","timestamp":1603774978740,"user_tz":-540,"elapsed":16529,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}}},"source":["output_data = layer(input_image)"],"execution_count":97,"outputs":[]},{"cell_type":"code","metadata":{"id":"r50wFkl6j1sY","executionInfo":{"status":"ok","timestamp":1603774978741,"user_tz":-540,"elapsed":16513,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}}},"source":["output = output_data.data"],"execution_count":98,"outputs":[]},{"cell_type":"code","metadata":{"id":"ZiIp-frJj2Hl","executionInfo":{"status":"ok","timestamp":1603774978741,"user_tz":-540,"elapsed":16482,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"c02e4700-6381-4ba6-de58-987dea3c77d9","colab":{"base_uri":"https://localhost:8080/","height":35}},"source":["output_arr = output.numpy()\n","output_arr.shape"],"execution_count":99,"outputs":[{"output_type":"execute_result","data":{"text/plain":["(1, 20, 24, 24)"]},"metadata":{"tags":[]},"execution_count":99}]},{"cell_type":"code","metadata":{"id":"uOHMu-UQkW3a","executionInfo":{"status":"ok","timestamp":1603774979180,"user_tz":-540,"elapsed":16895,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"ecb16790-4e45-4b79-96bc-c6f91406e2e0","colab":{"base_uri":"https://localhost:8080/","height":314}},"source":["plt.figure(figsize=(15,30))\n","\n","plt.subplot(131)\n","plt.title(\"input\")\n","plt.imshow(image, 'gray')\n","plt.subplot(132)\n","plt.title(\"weight\")\n","plt.imshow(weight[0,0,:,:], 'jet')\n","plt.subplot(133)\n","plt.title(\"Output\")\n","plt.imshow(output_arr[0,0,:,:], 'gray')"],"execution_count":100,"outputs":[{"output_type":"execute_result","data":{"text/plain":["<matplotlib.image.AxesImage at 0x7fe2aec19dd8>"]},"metadata":{"tags":[]},"execution_count":100},{"output_type":"display_data","data":{"image/png":"iVBORw0KGgoAAAANSUhEUgAAA2IAAAEhCAYAAAAd/BN5AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4yLjIsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+WH4yJAAAgAElEQVR4nO3de1xVdb7/8feWLQKKXLaAUmZZppzQcUyn0KMG2nhpenipk0bio0eNvzqeHK2HdTiU1mM8o4lNU9qURuWMlyZGrKaLicfSslQqayxM89LkhVABETHYGsjvjx5SeGF9xc1ae29ez79k7zff74ele7k+rMvXVVdXVycAAAAAgG1aOV0AAAAAALQ0NGIAAAAAYDMaMQAAAACwGY0YAAAAANiMRgwAAAAAbEYjBgAAAAA2oxHDWb744gvdfffdPh+3tLRU7777rs/HBYAzDR8+XKWlpY1mMjMz9eyzz57zvQ0bNui7775rjtIABIG6ujr99a9/1c0336zhw4dr2LBhmjlzpo4cOWL5vX//+98vau5vvvlGn3zyyUWNAf9AI4az9OrVSy+++KLPxy0oKNB7773n83EB4EyrV69Whw4dmvz9f/nLX2jEAJzXn/70J7355pvKycnR6tWr9fbbbysyMlIZGRnyer3n/b6SkhK98MILFzX32rVracSCBI0YzlJQUKAbb7xRCxYs0O9//3v913/9l4YMGaJbb71Vhw8fliSlpaUpJydHY8eO1fXXX6+nnnqqwfeeOda2bdv0+9//Xvn5+br//vsd+bkABJbBgwdr7969kqRVq1YpOTlZ1dXVkqTFixfr0Ucf1f/+7/9q2LBhSktL08KFC+u/t3v37jp48KBOnTqlWbNmacCAAbr99tv1/PPPKyMjoz5XUVGhSZMm6YYbbtDdd9+t48eP66mnntLmzZv14IMPatWqVfb+0AD83tGjR/XXv/5V8+bNU8eOHSVJbrdbDz74oNq0aaN//OMf9fug005/PX78eH333XcaPny4Tp48qe7du2vJkiUaNWqUUlJS9Le//U2S9Oqrr+rOO++s//7TX7/33ntatGiRlixZoscff9zWnxu+RyOGRq1evVpZWVlau3atPB6PVq5cWf/eP//5T61YsUJvv/22Xn75Ze3YseO841xzzTWaMGGChg0bpj/96U92lA4gwF133XX6/PPPJUmffPKJrrnmGn3xxReSpE8//VRxcXHavXu33nzzTb311lvKz8/XunXrGozx/vvv64MPPtCaNWv03HPP6bXXXmvw/kcffaR58+Zp7dq1Kisr09q1azVt2jQlJCRo3rx5GjlypD0/LICAsXXrVnXq1ElXXHHFWe+lpaXp448/Pu/3zp49W506ddLq1asVGhoqSdq7d6/+8Y9/aPny5Zo9e7bKy8vP+/1paWm68cYbNXHiRGVmZl78DwNH0YihUX379tUll1wil8ulpKQkFRcX1783evRohYSEyOPx6Nprr9Vnn33mYKUAgs11112nf/7zn5J+PPC59dZb6/czW7du1dq1a5Wenq7Q0FBFRERo1KhRWrNmTYMxPv30U91www1q27atoqOjddNNNzV4f9CgQYqOjpbb7Va3bt106NAhe344AAHr6NGjio2NPed7Ho9HFRUVFzTeLbfcIknq2rWrrrjiivpfOCH40YihUZGRkfV/DgkJUW1tbf3XUVFRDf587NgxW2sDENxON2IVFRVq3bq1rr/+en322Wfas2ePOnXqpOrqas2ZM0fDhw/X8OHDtWTJkvpLF087duxYg31VQkJCg/fbtWtX/+cz93EAcC4xMTH1t2qcqaysTB6P54LG43iq5XI7XQAC189PnR89elRRUVFnHciwMwHQVJdeeqmqqqq0YcMG9e7dW507d9aBAwe0ZcsWpaSk6PPPP9ddd92l1NTU847Rrl07VVVV1X9dUlJiR+kAgtgvf/lLVVRUaMeOHerRo0eD99atW6eMjAy98cYb9cdDVmfIysvLdckll0j66XjqyJEjHE+1AJwRQ5OtWrVKp06dUmlpqT777DP17dtXcXFxKikpUVlZmWpra/Xmm2/W591utyorKx2sGECgufbaa7VkyRL16dNH0o+X7qxcuVIpKSkaMmSIVqxYodraWtXV1enZZ5/VBx980OD7e/bsqfXr18vr9erYsWN65513jOZlfwXgfCIjI3XvvffqwQcf1P79+yVJNTU1+uMf/6hTp05p5MiRiouLq793fuXKlWrV6sdDbrfbraqqKtXU1NSP9/bbb0uS9uzZo7179+oXv/iF4uPj9a9//UsnTpxQdXW1Vq9eXZ9n/xQ8aMTQZN26ddOtt96qm266SRkZGerWrZu6dOmiW265RaNHj1Z6erquv/76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\n","text/plain":["<Figure size 1080x2160 with 3 Axes>"]},"metadata":{"tags":[]}}]},{"cell_type":"markdown","metadata":{"id":"6sCqGmH_kwHm"},"source":["### Pooling\n","- `F.max_pool2d` \n","  - `stride`\n","\n","  - `kernel_size`\n","\n","- `torch.nn.MaxPool2d` 도 많이 사용"]},{"cell_type":"code","metadata":{"id":"AYqPrLH1kxQl","executionInfo":{"status":"ok","timestamp":1603774979180,"user_tz":-540,"elapsed":16877,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"b3726b7c-5a1a-4ece-c87b-0f072f30afc7","colab":{"base_uri":"https://localhost:8080/","height":35}},"source":["image.shape"],"execution_count":101,"outputs":[{"output_type":"execute_result","data":{"text/plain":["(28, 28)"]},"metadata":{"tags":[]},"execution_count":101}]},{"cell_type":"code","metadata":{"id":"tvI8W_8Yk81S","executionInfo":{"status":"ok","timestamp":1603774979181,"user_tz":-540,"elapsed":16858,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"0035b84a-1807-4674-c2ac-a2a72800fde8","colab":{"base_uri":"https://localhost:8080/","height":35}},"source":["pool = F.max_pool2d(output, 2, 2)\n","pool.shape"],"execution_count":102,"outputs":[{"output_type":"execute_result","data":{"text/plain":["torch.Size([1, 20, 12, 12])"]},"metadata":{"tags":[]},"execution_count":102}]},{"cell_type":"markdown","metadata":{"id":"aV3HK4FulCaJ"},"source":["- MaxPool Layer는 weight가 없기 때문에 바로 `numpy()`변환 가능"]},{"cell_type":"code","metadata":{"id":"fseB_qlflBta","executionInfo":{"status":"ok","timestamp":1603774979181,"user_tz":-540,"elapsed":16840,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"a10b42fc-4d91-4762-8281-eaabad31fa09","colab":{"base_uri":"https://localhost:8080/","height":35}},"source":["pool_arr = pool.numpy()\n","pool_arr.shape"],"execution_count":103,"outputs":[{"output_type":"execute_result","data":{"text/plain":["(1, 20, 12, 12)"]},"metadata":{"tags":[]},"execution_count":103}]},{"cell_type":"code","metadata":{"id":"6w8DQnNtlNCq","executionInfo":{"status":"ok","timestamp":1603774979182,"user_tz":-540,"elapsed":16830,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"b77d46aa-9bc6-4f89-c698-838516babc66","colab":{"base_uri":"https://localhost:8080/","height":313}},"source":["plt.figure(figsize=(10,15))\n","plt.subplot(121)\n","plt.title(\"input\")\n","plt.imshow(image, 'gray')\n","plt.subplot(122)\n","plt.title(\"output\")\n","plt.imshow(pool_arr[0,0,:,:], 'gray')\n","plt.show()"],"execution_count":104,"outputs":[{"output_type":"display_data","data":{"image/png":"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\n","text/plain":["<Figure size 720x1080 with 2 Axes>"]},"metadata":{"tags":[]}}]},{"cell_type":"markdown","metadata":{"id":"q7RVioKwlbH1"},"source":["### Linear\n","- 1d만 가능 `.view()`를 통해 1D로 펼쳐줘야함"]},{"cell_type":"code","metadata":{"id":"Kwcedadrlcbl","executionInfo":{"status":"ok","timestamp":1603774979588,"user_tz":-540,"elapsed":17226,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"a55d33e3-9b78-4ae4-cfcc-835e48ca7676","colab":{"base_uri":"https://localhost:8080/","height":35}},"source":["image = torch.from_numpy(image)\n","image.shape"],"execution_count":105,"outputs":[{"output_type":"execute_result","data":{"text/plain":["torch.Size([28, 28])"]},"metadata":{"tags":[]},"execution_count":105}]},{"cell_type":"code","metadata":{"id":"_mYQy4I3lmAm","executionInfo":{"status":"ok","timestamp":1603774979589,"user_tz":-540,"elapsed":17214,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"570fae2e-a9e4-4d4c-bfa8-bcd9058d9512","colab":{"base_uri":"https://localhost:8080/","height":35}},"source":["flatten = image.view(1, 28*28)\n","flatten.shape"],"execution_count":106,"outputs":[{"output_type":"execute_result","data":{"text/plain":["torch.Size([1, 784])"]},"metadata":{"tags":[]},"execution_count":106}]},{"cell_type":"code","metadata":{"id":"6wgSmY0Zlofk","executionInfo":{"status":"ok","timestamp":1603774979590,"user_tz":-540,"elapsed":17205,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"68d9e89a-4409-4427-eaec-c10ba187637b","colab":{"base_uri":"https://localhost:8080/","height":35}},"source":["lin = nn.Linear(784, 10)(flatten)\n","lin.shape"],"execution_count":107,"outputs":[{"output_type":"execute_result","data":{"text/plain":["torch.Size([1, 10])"]},"metadata":{"tags":[]},"execution_count":107}]},{"cell_type":"code","metadata":{"id":"LcJFqf0alsxr","executionInfo":{"status":"ok","timestamp":1603774979590,"user_tz":-540,"elapsed":17196,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"11cb204b-db2f-4a1d-b25a-006064c555cb","colab":{"base_uri":"https://localhost:8080/","height":71}},"source":["lin"],"execution_count":108,"outputs":[{"output_type":"execute_result","data":{"text/plain":["tensor([[-1.9558e-01,  1.4194e-01, -1.1120e-04,  5.1400e-02, -7.4812e-01,\n","          6.1233e-02,  1.6906e-02, -1.9468e-02, -2.9292e-01,  2.5844e-01]],\n","       grad_fn=<AddmmBackward>)"]},"metadata":{"tags":[]},"execution_count":108}]},{"cell_type":"code","metadata":{"id":"ewEpebSVluHz","executionInfo":{"status":"ok","timestamp":1603774979591,"user_tz":-540,"elapsed":17188,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"0e03f187-a2d0-4fef-fd89-9e66cb0b94bb","colab":{"base_uri":"https://localhost:8080/","height":266}},"source":["plt.imshow(lin.detach().numpy(), 'jet')\n","plt.colorbar()\n","plt.show()"],"execution_count":109,"outputs":[{"output_type":"stream","text":["\n"],"name":"stdout"},{"output_type":"display_data","data":{"image/png":"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\n","text/plain":["<Figure size 432x288 with 2 Axes>"]},"metadata":{"tags":[]}}]},{"cell_type":"markdown","metadata":{"id":"0IjPKDKRl3CV"},"source":["### Softmax"]},{"cell_type":"code","metadata":{"id":"obhBb3O-lzbs","executionInfo":{"status":"ok","timestamp":1603774979591,"user_tz":-540,"elapsed":17176,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}}},"source":["with torch.no_grad():\n","  flatten = image.view(1, 28*28)\n","  lin == nn.Linear(784, 10)(flatten)\n","  softmax =F.softmax(lin, dim=1)"],"execution_count":110,"outputs":[]},{"cell_type":"code","metadata":{"id":"ljgOEyNMmBEE","executionInfo":{"status":"ok","timestamp":1603774979592,"user_tz":-540,"elapsed":17165,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"5e9c5a06-1e82-4485-f5de-298e51c7b3a8","colab":{"base_uri":"https://localhost:8080/","height":53}},"source":["softmax"],"execution_count":111,"outputs":[{"output_type":"execute_result","data":{"text/plain":["tensor([[0.0856, 0.1200, 0.1041, 0.1096, 0.0493, 0.1107, 0.1059, 0.1021, 0.0777,\n","         0.1348]])"]},"metadata":{"tags":[]},"execution_count":111}]},{"cell_type":"code","metadata":{"id":"18ymFSRAmBo7","executionInfo":{"status":"ok","timestamp":1603774979594,"user_tz":-540,"elapsed":17156,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"4ca0ebba-2de1-4f1a-c15b-8e3b2754b548","colab":{"base_uri":"https://localhost:8080/","height":35}},"source":["np.sum(softmax.numpy())"],"execution_count":112,"outputs":[{"output_type":"execute_result","data":{"text/plain":["1.0"]},"metadata":{"tags":[]},"execution_count":112}]},{"cell_type":"markdown","metadata":{"id":"bYh13Bnj5wEN"},"source":["### F.relu\n","\n","- ReLU 함수를 적용하는 레이어\n","\n","- `nn.ReLU`로도 사용 가능"]},{"cell_type":"code","metadata":{"id":"D4VFePpR9_Ak","executionInfo":{"status":"ok","timestamp":1603774979595,"user_tz":-540,"elapsed":17147,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"b9a70f9e-6f75-4546-c81f-f1e58829db6c","colab":{"base_uri":"https://localhost:8080/","height":35}},"source":["inputs = torch.randn(4,3, 28, 28).to(device)\n","inputs.shape"],"execution_count":113,"outputs":[{"output_type":"execute_result","data":{"text/plain":["torch.Size([4, 3, 28, 28])"]},"metadata":{"tags":[]},"execution_count":113}]},{"cell_type":"code","metadata":{"id":"1lKlSiaY5wZW","executionInfo":{"status":"ok","timestamp":1603774979596,"user_tz":-540,"elapsed":17139,"user":{"displayName":"Seung min Yang","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14Ggh6p0khXlZ7IJRTGo-8JTqKaaHhMlpE2ET1kqtYQ=s64","userId":"01177916219728503153"}},"outputId":"f325e4a5-58be-4295-bd5f-8ee637d28329","colab":{"base_uri":"https://localhost:8080/","height":35}},"source":["layer = nn.Conv2d(3, 20, 5, 1).to(device)\n","output = F.relu(layer(inputs))\n","output.shape"],"execution_count":114,"outputs":[{"output_type":"execute_result","data":{"text/plain":["torch.Size([4, 20, 24, 24])"]},"metadata":{"tags":[]},"execution_count":114}]},{"cell_type":"markdown","metadata":{"id":"0yuABl4h-yye"},"source":["## Optimizer\n","\n","- `import torch.optim as optim`\n","\n","- `model`의 파라미터를 업데이트\n","\n","- 예시)\n","  ```python\n","  optimizer = torch.optim.Adam(model.parameters(), lr=1e-4, weight_decay=1e-5)\n","  optimizer = optim.SGD(model.parameters(), lr=0.001)\n","  ```\n","\n","- `.zero_grad()`로 초기화\n","- `.step()`으로 업데이트\n","\n"]}]}